<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DOA Reader</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.5; }
    
    /* Utility Classes */
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .flex-wrap { flex-wrap: wrap; }
    .items-center { align-items: center; }
    .items-start { align-items: flex-start; }
    .justify-between { justify-content: space-between; }
    .justify-center { justify-content: center; }
    .gap-2 { gap: 8px; }
    .gap-3 { gap: 12px; }
    .gap-4 { gap: 16px; }
    .gap-6 { gap: 24px; }
    .grid { display: grid; }
    .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
    .text-center { text-align: center; }
    .text-left { text-align: left; }
    .font-bold { font-weight: 700; }
    .font-semibold { font-weight: 600; }
    .font-medium { font-weight: 500; }
    .text-xs { font-size: 12px; }
    .text-sm { font-size: 14px; }
    .text-base { font-size: 16px; }
    .text-lg { font-size: 18px; }
    .text-xl { font-size: 20px; }
    .text-2xl { font-size: 24px; }
    .uppercase { text-transform: uppercase; }
    .tracking-wide { letter-spacing: 0.05em; }
    .rounded { border-radius: 4px; }
    .rounded-lg { border-radius: 8px; }
    .rounded-xl { border-radius: 12px; }
    .rounded-2xl { border-radius: 16px; }
    .rounded-3xl { border-radius: 24px; }
    .rounded-full { border-radius: 9999px; }
    .p-3 { padding: 12px; }
    .p-4 { padding: 16px; }
    .p-5 { padding: 20px; }
    .p-6 { padding: 24px; }
    .p-8 { padding: 32px; }
    .px-3 { padding-left: 12px; padding-right: 12px; }
    .px-4 { padding-left: 16px; padding-right: 16px; }
    .px-5 { padding-left: 20px; padding-right: 20px; }
    .px-6 { padding-left: 24px; padding-right: 24px; }
    .py-1 { padding-top: 4px; padding-bottom: 4px; }
    .py-2 { padding-top: 8px; padding-bottom: 8px; }
    .py-3 { padding-top: 12px; padding-bottom: 12px; }
    .py-4 { padding-top: 16px; padding-bottom: 16px; }
    .mb-1 { margin-bottom: 4px; }
    .mb-2 { margin-bottom: 8px; }
    .mb-4 { margin-bottom: 16px; }
    .mb-6 { margin-bottom: 24px; }
    .mt-1 { margin-top: 4px; }
    .mt-2 { margin-top: 8px; }
    .mt-4 { margin-top: 16px; }
    .mt-6 { margin-top: 24px; }
    .ml-2 { margin-left: 8px; }
    .w-full { width: 100%; }
    .max-w-7xl { max-width: 1280px; }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .min-h-screen { min-height: 100vh; }
    .overflow-hidden { overflow: hidden; }
    .overflow-y-auto { overflow-y: auto; }
    .cursor-pointer { cursor: pointer; }
    .transition { transition: all 0.2s ease; }
    .opacity-50 { opacity: 0.5; }
    .opacity-60 { opacity: 0.6; }
    .line-through { text-decoration: line-through; }
    .relative { position: relative; }
    .absolute { position: absolute; }
    .fixed { position: fixed; }
    .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
    .z-10 { z-index: 10; }
    .z-50 { z-index: 50; }
    .border { border-width: 1px; border-style: solid; }
    .border-t { border-top-width: 1px; border-top-style: solid; }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
    .backdrop-blur { backdrop-filter: blur(8px); }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(128,128,128,0.3); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(128,128,128,0.5); }
    
    /* Form elements */
    input, select { outline: none; }
    input:focus, select:focus { box-shadow: 0 0 0 2px rgba(0,107,107,0.5); }
    button { border: none; cursor: pointer; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    
    /* Responsive grid */
    @media (min-width: 768px) {
      .md-grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
      .md-grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
    }
    
    /* Animation */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
  </style>

  <script type="application/json" id="browse-doa-data">[{"code": "1", "title": "CORPORATE ORGANISATION & STRUCTURE", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.1", "title": "Corporate Structure", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.1.1", "title": "Establish By-Laws/ Articles of Association and JV Agreements", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.2.1", "title": "Amendment of By-laws & AoA", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.1.1", "title": "Amendment of TAQA's By-laws", "description": "TAQA", "comments": "", "function": "Legal", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.2.1.1", "title": "Amendment of TAQA's Wholly owned By-laws and AOA:", "description": "Wholly Owned", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.1.1.1", "title": "a) Capital increase/ decrease,  change of the Head Office and Objectives of the Company", "description": "Wholly Owned", "comments": "X2*: Board approval required only for changing company objective if it is change in the core business of the company.", "function": "Corporate Governance", "approvalChain": [{"role": "BOD", "action": "X2*", "kind": "X"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R1", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.2.1.1.2", "title": "b) Other", "description": "Wholly Owned", "comments": "", "function": "Corporate Governance", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.1", "title": "Incorporation of Branch Offices", "description": "", "comments": "In accordance with TAQA Bylaw - Article 5", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.1.1", "title": "Incorporation of Branch Offices of TAQA", "description": "TAQA", "comments": "In accordance with TAQA Bylaw - Article 5", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.1.2", "title": "Incorporation of Branch Offices of a Wholly owned:", "description": "Wholly Owned", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.1.2.1", "title": "a) Incorporation of Branch Offices  (Out-of-Country)", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.1.2.1", "title": "b) Incorporation of Branch Offices (In-Country)", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.2", "title": "Board of Directors Structure", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.1", "title": "Nomination & Appointment & Removal of a BoD Member", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.1.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "", "function": "TAQA General Assembly", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.1.2", "title": "For Wholly owned BOD", "description": "Wholly Owned", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.2.2", "title": "Appointment & Termination of BOD Chairman and Vice Chairman", "description": "", "comments": "E1*: NRC endorsement applies only on wholly owned related matter.", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.2.3", "title": "Temporary and Subsequent appointment of Board of Directors", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.3.1", "title": "For TAQA:", "description": "TAQA", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.3.1.1", "title": "a) Temporary appointment of a new Director to replace the vacant position of the terminated or resigned Director", "description": "TAQA", "comments": "X1*: In accordance with TAQA's By-laws - Article 26", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1*", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.3.1.2", "title": "b) Final appointment of a new Director to replace the vacant position of the terminated or resigned Director", "description": "TAQA", "comments": "", "function": "TAQA General Assembly", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.3.2", "title": "For a Wholly owned of TAQA:", "description": "Wholly Owned", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.3.2.1", "title": "Temporary & Final appointment of a new Director to replace the vacant position of the terminated or resigned Director", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.2.4", "title": "Approval of Board annual remuneration", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.4.1", "title": "Approval of TAQA BOD annual remuneration", "description": "TAQA", "comments": "", "function": "TAQA General Assembly", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.4.2", "title": "Approval of TAQA payment to remunerate its appointed employees on subsidiaries/affiliates boards as applicable per TAQA Policy", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.2.5", "title": "Approval of  annual remuneration for TAQA board committees' members, secretaries and board's Secretary", "description": "TAQA", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.6", "title": "Resignation of TAQA BOD Member or BOD Committee member", "description": "TAQA", "comments": "N*: General assembly is notified on the resigned board member only. The notification is done during the next general assembly meeting after the resignation", "function": "TAQA Board of Directors", "approvalChain": [{"role": "General Assembly", "action": "N*", "kind": "N"}, {"role": "BOD", "action": "N", "kind": "N"}, {"role": "NRC", "action": "N", "kind": "N"}]}, {"code": "1.2.7", "title": "Appointment and Termination of BOD Secretary", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.2.7.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}]}, {"code": "1.2.7.2", "title": "For a Wholly Owned BOD", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.3", "title": "Board Committees Structure", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.1", "title": "Establishment and Dissolving BOD Committees", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.1.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "1.3.1.2", "title": "For Wholly Owned BOD", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.3.2", "title": "Appointment of new Committee members or to replace a vacant position of a terminated or resigned member:", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "1.3.2.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "", "function": "Corporate Organisation", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "1.3.2.2", "title": "For Wholly Owned BOD", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.3.3", "title": "Appointment and Termination of Chairmanship and Secretary of the Committee", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.3.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "X1*: Each committee will appoint its chairman and secretary", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1*", "kind": "X"}, {"role": "NRC", "action": "X1*", "kind": "X"}, {"role": "Audit Committee", "action": "X1*", "kind": "X"}, {"role": "Risk & Sustainability", "action": "X1*", "kind": "X"}]}, {"code": "1.3.3.2", "title": "For Wholly Owned BOD", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.3.4", "title": "Approval and amendment of TAQA Audit Committee (AC) and Nomination & Remuneration Committee (NRC) Charters", "description": "TAQA", "comments": "R3*: Respective Committee, i.e., AC or NRC, to initiate the charter draft or review", "function": "TAQA Board of Directors", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "R3*", "kind": "R"}, {"role": "Audit Committee", "action": "R3*", "kind": "R"}, {"role": "Risk & Sustainability", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.5", "title": "Approval and amendment of other TAQA's Board Committees Charters", "description": "TAQA", "comments": "1.R3*: Each committee will draft and review its Charter\n2. R3**: All Board Committees' charters shall be reviewed by the NRC as part of its responsibilities on the Board Governance.", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "R3*", "kind": "R"}, {"role": "NRC", "action": "R3**", "kind": "R"}, {"role": "Audit Committee", "action": "R3*", "kind": "R"}, {"role": "Risk & Sustainability", "action": "R3*", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.6", "title": "Approval and amendment of Wholly Owned BOD Committee's Charters", "description": "Wholly Owned", "comments": "X*: Corresponding TAQA BOD committee approves the wholly owned Committee's charter", "function": "Corporate Development", "approvalChain": [{"role": "ExCom", "action": "X1*", "kind": "X"}, {"role": "NRC", "action": "X1*", "kind": "X"}, {"role": "Audit Committee", "action": "X1*", "kind": "X"}, {"role": "Risk & Sustainability", "action": "X1*", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.3.7", "title": "Termination of a BoD's Committee Member", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.7.1", "title": "For TAQA BOD", "description": "TAQA", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "N", "kind": "N"}]}, {"code": "1.3.7.2", "title": "For Wholly Owned BOD", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.3.8", "title": "Establishing and Dissolving Management Committees, including members appointment and termination:", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.3.8.1", "title": "For TAQA", "description": "TAQA", "comments": "", "function": "CEO Office", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}]}, {"code": "1.3.8.2", "title": "For Wholly Owned", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.4", "title": "Business Terms & Continuity", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.4.1", "title": "Dissolve TAQA", "description": "TAQA", "comments": "In accordance with TAQA's By-laws", "function": "TAQA Board of Directors", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "1.4.2", "title": "Dissolve a wholly-owned operating subsidiary or part of it", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.4.3", "title": "Merger of a wholly-owned operating subsidiary or part of it", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.5", "title": "Corporate Governance Framework", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.5.1", "title": "Approval of Board and Board Committees' Remuneration & Compensation Charter/Policy", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.5.1.1", "title": "For TAQA", "description": "TAQA", "comments": "", "function": "TAQA Board of Directors", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.1.2", "title": "For a Wholly Owned of TAQA", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.2", "title": "Approval of TAQA Shareholder manual, Board membership policy, Board Charter, Shareholder Transparency & Disclosure policy", "description": "TAQA", "comments": "", "function": "GRC", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.3", "title": "TAQA Corporate Governance Manuals/Charters", "description": "TAQA", "comments": "", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.4", "title": "Wholly Owned Corporate Governance Manuals/Charters, including Shareholder manual, Board membership policy, and Board governance charter", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.5", "title": "Approval/Amendment of Authority Matrix", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.5.5.1", "title": "TAQA DOA (TAQA Prime & Partially owned Matrix)", "description": "TAQA", "comments": "R2*: Required for Partially owned matrices only", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R2*", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.5.2", "title": "Drafting and approving specific DOA for a TAQA subsidiary", "description": "Wholly Owned", "comments": "1. X1*: TAQA CEO has the authority to solely approve specific drafted DOAs for wholly owned or partially owned subsidiaries provided these DOAs are within the delegations of the \"TAQA Prime\" and/or \"TAQA Wholly & Partially  Owned\" DOA's approved by TAQA Board.\n2. As an exception to the above note, ARGAS DOA shall always be approved by TAQA Board", "function": "GRC", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R2*", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.5.6", "title": "Approval of TAQA Annual & Interim Dividends payout", "description": "TAQA", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "General Assembly", "action": "X2", "kind": "X"}, {"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "1.5.7", "title": "Appointment, Renewal, & Termination of External Auditor for TAQA", "description": "TAQA", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Internal Audit", "action": "R1", "kind": "R"}]}, {"code": "1.5.8", "title": "Annual TAQA BOD report to shareholders", "description": "TAQA", "comments": "", "function": "GRC", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP GRC", "action": "R2", "kind": "R"}]}, {"code": "1.5.9", "title": "Approval of TAQA Related Parties Transactions and Conflict of Interest", "description": "TAQA", "comments": "GA may delegate this authority to the BOD in accordance with article 18 of the Executive Regulations of the Companies Law", "function": "Corporate  Finance", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R2", "kind": "R"}]}, {"code": "1.5.10", "title": "Approval of Ordinary General Assembly Items of a Wholly Owned:", "description": "Wholly Owned", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.5.10.1", "title": "Annual & Interim Dividends Distribution", "description": "Wholly Owned", "comments": "", "function": "Corporate  Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "1.5.10.2", "title": "BOD Discharge", "description": "Wholly Owned", "comments": "", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.5.10.3", "title": "BOD Remuneration Payout", "description": "Wholly Owned", "comments": "", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "1.5.10.4", "title": "Year-End Financial Statements", "description": "Wholly Owned", "comments": "", "function": "Corporate  Finance", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "1.5.10.5", "title": "Auditor Report", "description": "Wholly Owned", "comments": "", "function": "Corporate  Finance", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}]}, {"code": "1.5.10.6", "title": "Appointment, Renewal, & Termination of External Auditor", "description": "Wholly Owned", "comments": "", "function": "Corporate  Finance", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "1.5.10.7", "title": "Approval of Related Parties Transactions and Conflict of Interest", "description": "Wholly Owned", "comments": "", "function": "Corporate  Finance", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "VP GRC", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "1.5.10.8", "title": "Annual BOD report to shareholders", "description": "Wholly Owned", "comments": "R1*: Respective CEO N-1 review the report as applicable to his domain\nX1*: Respective subsidiary Board of Directors review the report before TAQA CEO approval", "function": "GRC", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1*", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1*", "kind": "R"}]}, {"code": "1.5.11", "title": "Approval of Extra-Ordinary General Assembly Items of a Wholly owned", "description": "Wholly Owned", "comments": "", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.6", "title": "Policies and Procedures", "description": "", "comments": "", "function": "Corporate Organisation", "approvalChain": []}, {"code": "1.6.1", "title": "TAQA Policies & Policy Statement", "description": "TAQA", "comments": "1-This would include not limited to Ethics and Business conducted related policies,  Financial Policy, Supply Chain, Information Technology, Policies Management, Public Safety and Environmental Health Policies, Compliance Charter Manual, Hedging Policy, M&A Policy, ERM Manual, BCM Manual, Corporate Social Responsibility Program, Corporate Social Responsibility Steering Committee Charter, if any. & Management Committee Charter.\n2- (E2*) - Endorsement to be done by the respective BOD committee, if applicable as per the respective charter.", "function": "GRC", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E2*", "kind": "E"}, {"role": "NRC", "action": "E2*", "kind": "E"}, {"role": "Audit Committee", "action": "E2*", "kind": "E"}, {"role": "Risk & Sustainability", "action": "E2*", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "QHSE", "action": "R1", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.6.2", "title": "Wholly Owned Policies and Policy Statement", "description": "Wholly Owned", "comments": "1-This would include not limited to Ethics and Business conducted related policies,  Supply Chain, Information Technology, Policies Management, Public Safety and Environmental Health Policies, Compliance Charter Manual, Hedging Policy, M&A Policy, ERM Manual, BCM Manual, Corporate Social Responsibility Program, Corporate Social Responsibility Steering Committee Charter, if any. & Management Committee Charter.\n2. CEO approval for a Wholly Owned policy or policy statement shall be based on adopted TAQA policy or aligned with TAQA's policies.", "function": "GRC", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.6.3", "title": "Financial & Accounting Manual/Standards", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "1.6.4", "title": "Employees Compensation and Benefits Policies/Framework", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "1.6.5", "title": "Dividends Policy", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "VP GRC", "action": "R1", "kind": "R"}]}, {"code": "1.6.6", "title": "Functional & Operational Policies /Standards/Procedures/ Manuals", "description": "", "comments": "This authority is delegable by the CEO N-1 to his direct reportee according to the functional structure", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "2", "title": "STRATEGIES & BUSINESS PLANS", "description": "", "comments": "", "function": "Strategy", "approvalChain": []}, {"code": "2.1", "title": "Approval, formulating, reviewing and amending TAQA's strategy and its wholly owned", "description": "", "comments": "", "function": "CEO Office", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "COO", "action": "R1", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "CTO", "action": "R1", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "Marketing & Commercial", "action": "R1", "kind": "R"}]}, {"code": "2.2", "title": "Approval / Revision of Long term (3-years) Rolling business plans for TAQA  and its wholly owned", "description": "", "comments": "", "function": "CEO Office", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "COO", "action": "R1", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "CTO", "action": "R1", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "Marketing & Commercial", "action": "R1", "kind": "R"}]}, {"code": "3", "title": "CORPORATE DEVELOPMENT", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.1", "title": "M&A Strategy and Criteria in line with TAQA approved Strategy", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.2", "title": "Gating System ( > SAR 200M )", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.2.1", "title": "a) Gate 0: No objection on business opportunity and partner selection", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "ExCom", "action": "N", "kind": "N"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.2.2", "title": "b) Gate 1: Authorize signing a non-binding LOI/ MoU", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.2.3", "title": "c) Gate 2: Approve valuation and deal structure", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.2.4", "title": "d) Gate 3: Approve transaction documentation (Summary of Key SPA terms)", "description": "", "comments": "1- CEO authorize documents after BoD approval on SPA terms summary\n2- In an event where a deviation arises from gate 2 approval, ExCom/Board approval will be re-obtained", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.3", "title": "Gating System ( > SAR 50M and ≤ SAR 200M)", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.3.1", "title": "a) Gate 0: No objection on business opportunity and partner selection", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "ExCom", "action": "N", "kind": "N"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.3.2", "title": "b) Gate 1: Authorize signing a non-binding LOI/ MoU", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.3.3", "title": "c) Gate 2: Approve valuation and deal structure", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.3.4", "title": "d) Gate 3: Approve transaction documentation (Summary of Key SPA terms)", "description": "", "comments": "1- CEO authorize documents after ExCom approval on SPA terms summary\n2- In an event where a deviation arises from gate 2 approval, ExCom/Board approval will be re-obtained", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.4", "title": "Gating System ( ≤  SAR 50M)", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.4.1", "title": "a) Gate 0: No objection on business opportunity and partner selection", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.4.2", "title": "b) Gate 1: Authorize signing a non-binding LOI/ MoU", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.4.3", "title": "c) Gate 2: Approve valuation and deal structure", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.4.4", "title": "d) Gate 3: Approve transaction documentation", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "3.5", "title": "Approval of Merger transaction of TAQA", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R1", "kind": "R"}, {"role": "CEO", "action": "R1", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.6", "title": "Approval of Merger Transaction of TAQA Wholly Owned Entity", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R1", "kind": "R"}]}, {"code": "3.7", "title": "Selection criteria and scope of work for investment banks", "description": "", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.8", "title": "Disposal of Investment Interest in a Wholly Owned Company (Value Creation)", "description": "", "comments": "Value creation refers to the investment related decision and initiated by corporate development. e.g. 1. very lucrative offer from the third party for the wholly owned subsidiary 2. sale of subsidiary in case the required value by TAQA is not realized due to recurring losses.", "function": "Corporate Development", "approvalChain": []}, {"code": "3.8.1.", "title": "Gate 0: Initiation of Divestiture process", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.8.2", "title": "Gate 1 : Not applicable", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.8.3", "title": "Gate 2: Authority to negotiate the post due diligence", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}]}, {"code": "3.8.4", "title": "Gate 3: Approve transaction documentation", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}]}, {"code": "3.9", "title": "Disposal of Investment Interest in a Wholly Owned Company (Strategic)", "description": "", "comments": "Strategic disposal refers to disposal decision based on strategical direction e.g. disposal of any business segment/ business line (e.g. wireline, cementing etc.) to align with strategy.", "function": "Corporate Development", "approvalChain": []}, {"code": "3.9.1", "title": "Gate 0: Initiation of Divestiture process", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "3.9.2", "title": "Gate 1 : Not applicable", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": []}, {"code": "3.9.3", "title": "Gate 2: Authority to negotiate the post due diligence", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}]}, {"code": "3.9.4", "title": "Gate 3: Approve transaction documentation", "description": "Wholly Owned", "comments": "", "function": "Corporate Development", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}]}, {"code": "4", "title": "Tenders & Customer Contracts", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.1", "title": "Entry to High-Risk Markets*", "description": "", "comments": "*: For any Confidentiality or Non- Disclosure Agreements/engagements with clients, business partners or any third party, refer to item 11.3.3 under Legal section of this DOA matrix", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.1.1", "title": "Customer Commitments (Bids, Quotes, Tenders, contracts, Spot Jobs and any other form of commitment) in a High-Risk Market: (Refer to Interpretation column for more details)", "description": "", "comments": "1. E1*: Either role as applicable to tender scope \n2. High Risk Market will be determined by Risk Function under GRC based on Market Risk Framework.\n3. A reviewing committee consists of: CEO, CFO, COO, Commercial & Marketing,  & General Counsel will be responsible for  reviewing the tender/contract risk and determine the contract risk profile and level", "function": "Commercial and Marketing", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E4*", "kind": "E"}, {"role": "COO", "action": "E1*", "kind": "E"}, {"role": "EPF", "action": "E1*", "kind": "E"}, {"role": "CFO", "action": "E3*", "kind": "E"}, {"role": "General Counsel", "action": "E2*", "kind": "E"}, {"role": "Marketing & Commercial", "action": "E1", "kind": "E"}]}, {"code": "4.2", "title": "Business in All other markets – not High Risk*", "description": "", "comments": "*: For any Confidentiality or Non- Disclosure Agreements/engagements with clients, business partners or any third party, refer to item 11.3.3 under Legal section of this DOA matrix", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.1", "title": "All Non-binding RFQs/RFPs/Quotes,….for client budgetary purposes (applies to non-contracted work, i.e. for new potential contract)", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.1.1", "title": "a) RFQ/RFP > SAR 50 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}]}, {"code": "4.2.1.2", "title": "b) SAR 18.75 Million < RFQ/RFP ≤ SAR 50 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "4.2.1.3", "title": "c) RFQ/RFP ≤ SAR 18.75 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X1", "kind": "X"}]}, {"code": "4.2.2", "title": "Customer Commitments (Bids, Quotes, Tenders, Contracts, Spot Jobs and any other form of commitment) :", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.2.1", "title": "1) Total Contract Value > SAR 200 Million (regardless of Capex value)", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E4", "kind": "E"}, {"role": "COO", "action": "E1*", "kind": "E"}, {"role": "EPF", "action": "E1*", "kind": "E"}, {"role": "CFO", "action": "E3", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "Marketing & Commercial", "action": "E1", "kind": "E"}]}, {"code": "4.2.2.2", "title": "2) SAR 50 Million < Total Contract Value ≤ SAR 200 Million (regardless of Capex value)", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E4", "kind": "E"}, {"role": "COO", "action": "E1*", "kind": "E"}, {"role": "EPF", "action": "E1*", "kind": "E"}, {"role": "CFO", "action": "E3", "kind": "E"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "Marketing & Commercial", "action": "E1", "kind": "E"}]}, {"code": "4.2.2.3", "title": "3) For any Contract Value with Capex > SAR 10 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "COO", "action": "E1*", "kind": "E"}, {"role": "EPF", "action": "E1*", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Marketing & Commercial", "action": "E1", "kind": "E"}]}, {"code": "4.2.3", "title": "4) All Commitments with: Total Contract Value ≤ SAR 50 Million and Capex ≤ SAR 10 Million:", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.3.1", "title": "Customer Commitments (Bids, Quotes, Tenders, Contracts, Spot Jobs and any other form of commitment) - excluding Direct Sales and EPF related commitments:", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.3.1.1", "title": "a) SAR 30 Million < Total Contract Value ≤ SAR 50 Million regardless of Capex; or for All contracts with SAR 5 Million < Capex ≤ SAR 10 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "COO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.1.2", "title": "b) SAR 5 Million < Total Contact value ≤ SAR 30 Million with/without Capex up to SAR 5 Million or Total Contract Value < SAR 5 Million and Capex up to SAR 5 Million", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.1.3", "title": "c) Total Contact value ≤ SAR 5 Million with/without Capex up to 10% Total Contract Value (fully loaded Operating Profit with net income > 10%)", "description": "", "comments": "", "function": "Commercial and Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2", "title": "Direct Sales Customer Commitments (Bids, Quotes, Tenders, Contracts,….)*", "description": "", "comments": "*: All authorities under this section don't cover Capex. Capex up to SAR 10 Million will require CEO, and for Capex more than SAR 10 Million will require ExCom", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.3.2.1", "title": "a) All Contracts with Gross Margin <40% regardless of Contract Value", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2.2", "title": "b) SAR 30 Million < Total Contract Value ≤ SAR 50 Million, with Gross Margin ≥ 40%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2.3", "title": "c) SAR 18.75 Million < Total Contract Value ≤ SAR 30 Million, with Gross Margin ≥ 40%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2.4", "title": "SAR 1.875 Million  < Total Contract Value ≤ SAR 18.75 Million, with Gross Margin ≥ 40%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "Head of PSL", "action": "X2", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2.5", "title": "d) Total Contracts Value ≤ SAR 1.875 Million, with Gross Margin ≥ 40%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "PSL/EPF Finance Controller", "action": "X1", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X2", "kind": "X"}]}, {"code": "4.2.3.2.4", "title": "d) Direct Service Lines Sales, e.g., Chemicals,… etc.:", "description": "", "comments": "", "function": "COO", "approvalChain": []}, {"code": "4.2.3.2.4.1", "title": "d.1) Product Total Cost Markup < 25%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X4", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.2.4.2", "title": "d.2) Product Total Cost Markup ≥ 25%", "description": "", "comments": "", "function": "COO", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "4.2.3.3", "title": "EPF Customer Commitments (Bids, Quotes, Tenders, Contracts,….)", "description": "", "comments": "", "function": "Tenders & Contracts", "approvalChain": []}, {"code": "4.2.3.3.1", "title": "Total Contract Value up to  SAR 50 Million with/without Capex up to SAR 10 Million", "description": "", "comments": "", "function": "EPF Head", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "EPF", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "X3", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "5", "title": "BUDGET & PERFORMANCE REPORTING", "description": "", "comments": "", "function": "Budget & Performance", "approvalChain": []}, {"code": "5.1", "title": "Approval/Revision of annual budget (operating plan)", "description": "", "comments": "In accordance with budget process and procedure", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}]}, {"code": "5.2", "title": "Budget re-allocation between departments within a same function/PSL (OPEX only)", "description": "", "comments": "X1*: one role to approve as applicable", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "5.3", "title": "Budget overrun (Capital & Operating Expenditure) *:", "description": "", "comments": "*Thresholds applies on line item of function/PSL budget (L2 as per Charts of Accounts structure)", "function": "Corporate Finance", "approvalChain": []}, {"code": "5.3.1", "title": "a) > 10%", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "5.3.2", "title": "b) > 5% and ≤ 10%", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "5.3.3", "title": "c) Up to SAR 1 million, OR 5%* (whatever is higher)", "description": "", "comments": "CEO may approve overrun up to SAR 1 million or up to 5% of line item (whichever is higher); line item (L2 as per CoA structure)", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "5.4", "title": "Un-budgeted (Operating Expenditure) – excluding manpower", "description": "", "comments": "1. Threshold percentages are calculated based on function/PSL OPEX budget excluding manpower budget.\n2. Refer to item 10.2.2 & 10.2.5 for unbudgeted manpower", "function": "Corporate Finance", "approvalChain": []}, {"code": "5.4.1", "title": "> 10%", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "5.4.2", "title": "> 5% and ≤ 10%", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "5.4.3", "title": "≤ 5%", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "5.5", "title": "Un-budgeted CAPEX", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "6", "title": "TREASURY & BANKING", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.1", "title": "Banking", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.1.1", "title": "Authorization to open bank accounts including online services, treasury accounts", "description": "", "comments": "In accordance with respective policies and procedures", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.1.2", "title": "Authorization to close bank accounts including online services, treasury accounts", "description": "", "comments": "In accordance with respective policies and procedures", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.1.3", "title": "Approving the bank authorized signatory list and online user master", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.1.4", "title": "Issuing Corporate Credit Cards, Including change in limits", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.1.5", "title": "Terminating Corporate Credit Cards", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Treasury Director", "action": "X1", "kind": "X"}]}, {"code": "6.1.6", "title": "Issuance of any Corporate or Performance Guarantee", "description": "TAQA", "comments": "Corporate will evaluate business needs and initiate the process and Treasury department will be the repository of all such documents.", "function": "Corporate Treasury", "approvalChain": []}, {"code": "6.1.6.1", "title": "a) > SAR 50 Million", "description": "TAQA", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "6.1.6.2", "title": "b) ≤ SAR 50 Million", "description": "TAQA", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "6.1.7", "title": "Liquidate 3rd Party Guarantees (parental, corporate, bank..etc.....)", "description": "", "comments": "N*: TAQA board is notified only if the transaction is under the Industrialization & Energy Services", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "N*", "kind": "N"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "6.1.8", "title": "Mortgages and pledge of assets*", "description": "", "comments": "pledge of assets: including but not limited to: land, buildings, equipment, rights, marketable and non-marketable securities", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.1.9", "title": "Issuance of loan securities or Instruments for public subscription (e.g. Sukuk)", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E1", "kind": "E"}, {"role": "ExCom", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.2", "title": "Cash Management", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.2.1", "title": "Intra-Company Transfer (transfers between the entity's bank accounts)", "description": "", "comments": "This covers only transfers within the entity's bank accounts", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Treasury Director", "action": "X1", "kind": "X"}]}, {"code": "6.2.2", "title": "Short Term Investment security for less than one year  (i.e. time deposit)", "description": "", "comments": "1. Short term investments that are: less than a year tenor, zero risk, Islamic deposit, 100% guaranteed capital, in accordance with the approved treasury policy", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Treasury Director", "action": "X1", "kind": "X"}]}, {"code": "6.2.3", "title": "Long Term Investment security for more than a year", "description": "", "comments": "More than a year and in accordance with approved treasury policy", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.2.4", "title": "Petty cash establishment, replenishment and termination", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": []}, {"code": "6.2.4.1", "title": "a) Petty cash establishment / Termination", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.2.4.2", "title": "b) Petty cash replenishment", "description": "", "comments": "In accordance with Petty Cash policy", "function": "End user", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Country Finance Lead", "action": "X1", "kind": "X"}]}, {"code": "6.2.5", "title": "Credit Card Replenishment", "description": "", "comments": "Replenishment means topping up the credit card limit before the period due date", "function": "End user", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.3", "title": "Hedging", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.3.1", "title": "Hedging Risk Management Strategy/Policy", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.3.2", "title": "Execution of Hedging within the approved strategy/policy  (notional amount)", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.4", "title": "Insurance (Excluding Medical Insurance)", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.4.1", "title": "Insurance policies & coverage / renewal / modification", "description": "", "comments": "", "function": "Insurance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X1", "kind": "X"}]}, {"code": "6.4.2", "title": "Placing claims against insurer", "description": "", "comments": "", "function": "Insurance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "6.4.3", "title": "Settlement of insurance claims at less than claimed amount:", "description": "", "comments": "", "function": "Insurance", "approvalChain": []}, {"code": "6.4.3.1", "title": "a) > SAR 10M", "description": "", "comments": "Difference  between claimed amount and Settlement amount", "function": "Insurance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.4.3.2", "title": "b) < SAR 10M", "description": "", "comments": "Difference  between claimed amount and Settlement amount", "function": "Insurance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "6.5", "title": "Loans & Facilities from Third Party & Financial Institutions", "description": "", "comments": "", "function": "Treasury & Banking", "approvalChain": []}, {"code": "6.5.1", "title": "Approval, amendment and renewal of Financing Facility Agreement (e.g. Letter of Credit, Letter of Guarantee, Working Capital, Term Loans, Standby Facility…etc.) including Terms and Conditions (i.e., Tenure, Rate, Covenants and Security and Source of loan repayment)", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": []}, {"code": "6.5.1.1", "title": "Any Term Loan (regardless of amount)", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.5.1.2", "title": "Working capital facilities > SAR 250 Million per facility", "description": "", "comments": "1- As per TAQA Corporate approved Operating Plan/financing budget or any other separate approval by the BoD. \n\n2- WC Facility (e.g. Standby Facility, Letter of Credit, Letter of Guarantee, Working Capital, Short Term Loans, …etc.)", "function": "Corporate Treasury", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.5.1.3", "title": "Working capital facilities ≤ SAR 250 Million per facility", "description": "", "comments": "1- As per approved Operating Plan/financing budget or any other separate approval by the BoD for projects and CAPEX purposes.\n\n 2- WC Facility (e.g. Standby Facility, Letter of Credit, Letter of Guarantee, Working Capital, Short Term Loans, …etc.)\n\n3- Provided that facility terms and conditions do not include dividend blockage, mortgages/pledging assets or any covenant affecting shareholders directly.", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "6.5.2", "title": "Utilization of Approved Bank Facility (e.g. Letter of Credit, Letter of Guarantee, Working Capital, Term Loans…etc.) for the same purpose of facility approval", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Treasury Director", "action": "X1", "kind": "X"}]}, {"code": "6.5.3", "title": "Availing corporate facility lines for direct utilization by subsidiaries and affiliates", "description": "", "comments": "R1*: required only if the role's scope applicable and relevant to the subsidiary under concern", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "EPF", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}]}, {"code": "6.5.4", "title": "Prepayment / early settlement of Loans", "description": "", "comments": "", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R1", "kind": "R"}]}, {"code": "6.5.5", "title": "Funding within TAQA Wholly-Owned Companies or Subsidiaries or Associate through TAQA or subsidiary to subsidiary within TAQA", "description": "", "comments": "R1*: required only if the role's scope applicable and relevant to the subsidiary under concern", "function": "Corporate Treasury", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "CEO", "action": "R3", "kind": "R"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "EPF", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "CTO", "action": "R1*", "kind": "R"}]}, {"code": "6.5.6", "title": "Utilization of approved funding within the group", "description": "", "comments": "R1*: required only if the role's scope applicable and relevant to the subsidiary under concern", "function": "Corporate Treasury", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "COO", "action": "R1*", "kind": "R"}, {"role": "EPF", "action": "R1*", "kind": "R"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "CTO", "action": "R1*", "kind": "R"}]}, {"code": "7", "title": "PAYMENTS", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.1", "title": "Payments related to Employees", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.1.1", "title": "Settlement / Payment of Employees business and training travel advances/expenses:", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.1.1.1", "title": "a) > SAR 250K", "description": "", "comments": "As per HR Policy", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "7.1.1.2", "title": "b) SAR 50K > Value ≤ SAR 250K", "description": "", "comments": "As per HR Policy", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}]}, {"code": "7.1.1.3", "title": "c) up to SAR 50K", "description": "", "comments": "", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "HR Business Partner", "action": "X1", "kind": "X"}]}, {"code": "7.1.2", "title": "Payroll/EOSB:", "description": "", "comments": "In accordance with HR Policy", "function": "Payments", "approvalChain": []}, {"code": "7.1.2.1", "title": "Corporate (TAQA)", "description": "TAQA", "comments": "1. This should cover the following centers in SAP (2020, 2010, 1010)\n2. The approved payroll by HR", "function": "HR", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}]}, {"code": "7.1.2.2", "title": "All other Countries", "description": "Wholly Owned", "comments": "The approved payroll by HR", "function": "HR", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}]}, {"code": "7.2", "title": "Payments related to vendors", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.2.1", "title": "Payment to Vendors ( against P.O):", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.2.1.1", "title": "a) > SAR 1,875,000", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "7.2.1.2", "title": "b) SAR 375,000 <Payment ≤ SAR 1,875,000", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X1", "kind": "X"}]}, {"code": "7.2.1.3", "title": "c) up to SAR 375,000", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X1", "kind": "X"}]}, {"code": "7.2.2", "title": "Approval of Contract Retention Release", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.2.2.1", "title": "a) > SAR 1,875,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "7.2.2.2", "title": "b) SAR 375,000 <Payment ≤ SAR 1,875,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}]}, {"code": "7.2.2.3", "title": "c) up to SAR 375,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}]}, {"code": "7.3", "title": "Payments to governmental and regulatory bodies:", "description": "", "comments": "", "function": "Payments", "approvalChain": []}, {"code": "7.3.1", "title": "Corporate Taxes/ Zakat/Other Taxes", "description": "", "comments": "1- Zakat, Income Tax, Withholding Tax, Value Added Tax (VAT) \n2- Other Taxes e.g. Property tax, levies.", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "X1", "kind": "X"}]}, {"code": "7.3.2", "title": "Employee Related Government Payments", "description": "", "comments": "In accordance with HR Policy", "function": "HR", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "HR Business Partner", "action": "X1", "kind": "X"}]}, {"code": "7.4", "title": "Payment of penalties by regulators and external parties", "description": "", "comments": "", "function": "End user all functions", "approvalChain": []}, {"code": "7.4.1", "title": "a) > SAR >100K", "description": "", "comments": "Notify GRC (Compliance and Risk Management functions)", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "7.4.2", "title": "b) SAR 50K< Penalty ≤SAR 100K", "description": "", "comments": "Notify GRC (Compliance and Risk Management functions)", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "7.4.3", "title": "c) up to SAR 50K", "description": "", "comments": "Notify GRC (Compliance and Risk Management functions)", "function": "End user all functions", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}]}, {"code": "7.5", "title": "Charity/CSR related payments/donations - Budgeted", "description": "", "comments": "To be within approved guidelines.  Cash donations based on approved budget and non-cash donation are based on net book value", "function": "Corporate Services", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "7.6", "title": "Charity/CSR related payments/donations - Unbudgeted", "description": "", "comments": "", "function": "Corporate Services", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "7.7", "title": "Duties and related services", "description": "", "comments": "Custom duties, clearance expenses, demurrage, import license…etc.", "function": "Supply Chain", "approvalChain": []}, {"code": "7.7.1", "title": "a) > SAR 1,875,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "7.7.2", "title": "b) SAR 375,000 <Payment ≤ SAR 1,875,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X1", "kind": "X"}]}, {"code": "7.7.3", "title": "c) up to SAR 375,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Country Finance Lead", "action": "X1", "kind": "X"}]}, {"code": "7.8", "title": "Dividends", "description": "", "comments": "* Following General Assembly approval on a distribution \n* Covers also dividends payment from subsidiaries to TAQA and from TAQA to Shareholders", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "7.9", "title": "Non P.O Invoices Approval and Payment (This applies only to invoices against contract, government related invoice, insurance or utilities invoices)* \n(Refer to interpretation section for exceptions)", "description": "", "comments": "Any exceptions for non-P.O invoices from the stated list, shall be approved or as delegated by the CFO", "function": "Payments", "approvalChain": []}, {"code": "7.9.1", "title": "a) Invoice Value > SAR 1,875,000", "description": "", "comments": "X3*: required only in case the non-P.O is related to Finance function", "function": "Corporate Finance", "approvalChain": [{"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X3*", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "7.9.2", "title": "b) SAR 375,000 < Invoice Value ≤ SAR 1,875,000", "description": "", "comments": "X3*: required only in case the non-P.O is related to Finance function", "function": "Corporate Finance", "approvalChain": [{"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP Supply Chain", "action": "X3*", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2*", "kind": "X"}, {"role": "FP&A Director", "action": "X2*", "kind": "X"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "7.9.3", "title": "c) Invoice Value ≤ SAR 375,000", "description": "", "comments": "X1*: one role only to approve as applicable\nX1**: Only for Slickline, Wireline, Inspection & Testing, and Well safety PSLs, the Head of PSL shall approve this bracket.\nX2*: one role only to approve as applicable\nX3*: required only in case the non-P.O is related to Finance function", "function": "Corporate Finance", "approvalChain": [{"role": "Head of PSL", "action": "X1**", "kind": "X"}, {"role": "Country Manager", "action": "X1*", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2*", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2*", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X3*", "kind": "X"}, {"role": "Support Dept Head", "action": "X1*", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X1*", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X1*", "kind": "X"}]}, {"code": "8", "title": "ACCOUNTING & FINANCIAL MATTERS", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.1", "title": "Statutory Financial Statements", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.1.1", "title": "Consolidated and TAQA Standalone:", "description": "TAQA", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.1.1.1", "title": "a) Interim Financial Statements (Quarterly)", "description": "TAQA", "comments": "CEO and CFO to jointly sign", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "8.1.1.2", "title": "b) Year-End Financial Statements", "description": "TAQA", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E4", "kind": "E"}, {"role": "Audit Committee", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}]}, {"code": "8.1.2", "title": "Signing TAQA Year-end Financial Statements", "description": "TAQA", "comments": "Chairman, CEO and CFO to sign jointly", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X3", "kind": "X"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}]}, {"code": "8.1.3", "title": "TAQA Annual BoD report to Shareholders", "description": "TAQA", "comments": "All head functions to recommend their part", "function": "Corporate Communication", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}]}, {"code": "8.1.4", "title": "Interim Financial Statements of a wholly owned (Quarterly)", "description": "Wholly Owned", "comments": "", "function": "Accounting & Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E4", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CEO", "action": "E3", "kind": "E"}, {"role": "CFO", "action": "E2", "kind": "E"}]}, {"code": "8.2", "title": "Management of Fixed Assets & Inventories -Impairment, Disposal & Sale", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.2.1", "title": "Approval on sale of more than (50%) of the total assets of the Company:", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.2.1.1", "title": "a) For TAQA", "description": "TAQA", "comments": "Gross book value of tangible assets as per latest reviewed/audited FS.", "function": "Corporate Finance", "approvalChain": [{"role": "General Assembly", "action": "X1", "kind": "X"}, {"role": "BOD", "action": "E2", "kind": "E"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R6", "kind": "R"}, {"role": "CEO", "action": "R6", "kind": "R"}, {"role": "COO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R5", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "8.2.1.2", "title": "b) For a Wholly owned of TAQA", "description": "Wholly Owned", "comments": "", "function": "Accounting & Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R6", "kind": "R"}, {"role": "CEO", "action": "R6", "kind": "R"}, {"role": "COO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R5", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "8.2.2", "title": "Sale of Assets (such as Plant, Equipment, Furniture, Fixtures, Motor Vehicles,…):", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.2.2.1", "title": "Approval of disposal list:", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.2.2.1.1", "title": "a) For TAQA", "description": "TAQA", "comments": "", "function": "Accounting & Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}]}, {"code": "8.2.2.2.2", "title": "b) For a Wholly owned", "description": "Wholly Owned", "comments": "R1*: required only as applicable", "function": "Corporate Finance", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R2", "kind": "R"}, {"role": "FP&A Director", "action": "R1*", "kind": "R"}]}, {"code": "8.2.2.2", "title": "Sell assets as approved by disposal list", "description": "", "comments": "R1*: required only as applicable", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "Group Financial Controller", "action": "R2", "kind": "R"}, {"role": "FP&A Director", "action": "R1*", "kind": "R"}]}, {"code": "8.2.3", "title": "Write-Off / Write Down or Adjustments of Assets (At Cost):", "description": "", "comments": "Adjustment means: the actual write off/ write down of the carrying value of the assets (advances, inventory, receivables,…). Provisions are set based on the approved Accounting Policy approved by the BOD.", "function": "Corporate Finance", "approvalChain": []}, {"code": "8.2.3.1", "title": "a) > SAR 10M annual aggregates", "description": "", "comments": "1. Aggregated annually for BOD approval", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R3", "kind": "R"}, {"role": "Group Financial Controller", "action": "R2", "kind": "R"}, {"role": "FP&A Director", "action": "R1*", "kind": "R"}]}, {"code": "8.2.3.2", "title": "b) ≤ SAR 10M annual aggregate", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "ExCom", "action": "N", "kind": "N"}, {"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R3", "kind": "R"}, {"role": "Group Financial Controller", "action": "R2", "kind": "R"}, {"role": "FP&A Director", "action": "R1*", "kind": "R"}]}, {"code": "8.2.4", "title": "Assets Impairment / revaluations (Goodwill, Intangibles, Investments, Fixed Assets, Inventory)", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R3", "kind": "R"}, {"role": "Group Financial Controller", "action": "R2", "kind": "R"}, {"role": "FP&A Director", "action": "R1*", "kind": "R"}]}, {"code": "8.2.5", "title": "Approval of scrap", "description": "", "comments": "1. X1*: one role to approve as applicable\n2. Scrap means: retirement by junk, lost in hole, physical wear and tear, beyond repair\n3. All approved scrap assets as per this item shall follow consequently item 8.2.3", "function": "Corporate Finance", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "8.2.6", "title": "Approval of CER/CPR", "description": "", "comments": "", "function": "Assets Integrity", "approvalChain": [{"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "8.2.6.1", "title": "CPR/CER for Growth Capex (refer to the interpretation column for the definition of growth capex)", "description": "", "comments": "Growth Capex: Budgeted new capex for existing contracts/projects or for qualification purposes.", "function": "Assets Integrity", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "8.2.6.2", "title": "CPR/CER for Maintenance Capex (refer to the interpretation column for the definition of maintenance capex)", "description": "", "comments": "Maintenance Capex: Budgeted capex for maintenance for the existing contracts/projects", "function": "Assets Integrity", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "8.2.6.3", "title": "CPR/CER for all other Capex", "description": "", "comments": "All capex for newly approved tenders.\nX2*: one role to approve as applicable", "function": "Assets Integrity", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2*", "kind": "X"}, {"role": "FP&A Director", "action": "X2*", "kind": "X"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "8.2.7", "title": "Transfer of Assets/Inventory within TAQA and Its Subsidiaries", "description": "", "comments": "", "function": "Assets Integrity", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "X2", "kind": "X"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}, {"role": "FP&A Director", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "8.2.8", "title": "Inventory Adjustments related to Counts, obsceneness, slow moving provision/SL, PL & Country", "description": "", "comments": "", "function": "Corporate Finance", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "R1", "kind": "R"}, {"role": "FP&A Director", "action": "R1", "kind": "R"}]}, {"code": "8.3", "title": "Land & Property", "description": "", "comments": "", "function": "Accounting & Finance", "approvalChain": []}, {"code": "8.3.1", "title": "Sale of owned Land and Property", "description": "", "comments": "Legal Counsel & Supply Chain to review legal/contractual documentation", "function": "Corporate Services", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "8.3.2", "title": "Purchase of a Land and Property", "description": "", "comments": "", "function": "Corporate Services", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "8.3.3", "title": "Lease of owned property to third parties", "description": "", "comments": "Legal Counsel & Supply Chain to review legal/contractual documentation", "function": "Corporate Services", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "9", "title": "CONTRACT & PROCUREMENT", "description": "", "comments": "", "function": "Contract & Procurement", "approvalChain": []}, {"code": "9.1", "title": "Approval of Single Source:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.1.1", "title": "a) Total Value of P.O/Contract > SAR 750,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "9.1.2", "title": "b) Total Value of P.O/Contract ≤ SAR 750,000", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "9.2", "title": "Approval of Sole Source Vendors", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "9.3", "title": "Purchase Requisition (PR) approval (Within approved budget CAPEX and OPEX)", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Support Dept Head", "action": "X1*", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X1*", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X1*", "kind": "X"}]}, {"code": "9.4", "title": "Approval / Amendment and Signing Purchase Order (Based on Approved PR)*:", "description": "", "comments": "For any Confidentiality or Non- Disclosure Agreements/engagements with suppliers or service providers, refer to item 11.3.3 under Legal section of this DOA matrix", "function": "Supply Chain", "approvalChain": []}, {"code": "9.4.1", "title": "For P.Os related to Shared Inventory managed by Supply Chain*:", "description": "", "comments": "Covering all shared inventories managed and requested by Supply Chain based on coordinated planning with SL", "function": "Supply Chain", "approvalChain": []}, {"code": "9.4.1.1", "title": "a) P.O Value > SAR 750,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X3", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Supply Chain Ops Director", "action": "X1", "kind": "X"}]}, {"code": "9.4.1.2", "title": "b) SAR 300,000 < P.O Value ≤ SAR 750,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "VP Supply Chain", "action": "X3", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Supply Chain Ops Director", "action": "X1", "kind": "X"}]}, {"code": "9.4.1.3", "title": "c) P.O Value ≤ SAR 300,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X3", "kind": "X"}, {"role": "Supply Chain Ops Director", "action": "X1", "kind": "X"}]}, {"code": "9.4.2", "title": "COO/EPF Organization P.Os Approval:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.4.2.1", "title": "a) P.O Value > SAR 3,000,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only\nX3*: one role only to approve as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "COO", "action": "X3*", "kind": "X"}, {"role": "EPF", "action": "X3*", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.2.2", "title": "b) SAR 750,000 < P.O Value ≤ SAR 3,000,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only\nX3*: one role only to approve as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X3*", "kind": "X"}, {"role": "EPF", "action": "X3*", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.2.3", "title": "c) SAR 105,000 < P.O Value ≤ SAR 750,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Head of PSL", "action": "X3", "kind": "X"}]}, {"code": "9.4.2.4", "title": "d) P.O Value ≤ SAR 105,000 (refer to the Interpretation for PSL applicability*)", "description": "", "comments": "1. R2*: required for Cross-border service P.Os only\n2. X3*: Only for Slickline, Wireline, Inspection & Testing, and Well safety PSLs, the Head of PSL shall approve this bracket.\n3. For P.Os load distribution, Supply Chain may request special delegation for other roles within the function for approving P.Os at this bracket, subject to the Endorsement of Governance and CEO approval", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Head of PSL", "action": "X3*", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X3", "kind": "X"}]}, {"code": "9.4.3", "title": "For Support Functions P.Os Approval:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.4.3.1", "title": "a) P.O Value > SAR 3,000,000", "description": "", "comments": "1. R2*: required for Cross-border service P.Os only\n2. X3*: To avoid dual role approval, in cases where the CEO or the respective CEO N-1 is a business proponent and he has another role to approve the same P.O, then the CEO or respective CEO N-1 will approve in his approval role and the CEO N-2 within the same function shall approve as a business proponent.\n3. For the purpose of segregation of duties, P.Os issued under Finance or Supply Chain, the respective N-2 role within the function will approve the P.O as support function Head", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X3*", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.3.2", "title": "b) SAR 750,000 < P.O Value ≤ SAR 3,000,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X3", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.3.3", "title": "c) SAR 105,000 < P.O Value ≤ SAR 750,000", "description": "", "comments": "1. R2*: required for Cross-border service P.Os only\n2. X3*: To avoid dual role approval, in cases where the Supply Chain or Finance is the business proponent, then respective CEO N-1 shall approve as Support Function Head.", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Support Function Head", "action": "X3*", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.3.4", "title": "d) P.O Value ≤ SAR 105,000", "description": "", "comments": "1. R2*: required for Cross-border service P.Os only\n2. X3**: Country manager to approve the P.O if there is no Department Head in the country\n3. For P.Os load distribution, Supply Chain may request special delegation for other roles within the function for approving P.Os at this bracket, subject to the Endorsement of Governance and CEO approval\n4.X3*: To avoid dual role approval, in cases where the Supply Chain or Finance is the business proponent, then respective function head shall approve as Support Department Head.", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Country Manager", "action": "X3**", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "Support Dept Head", "action": "X3*", "kind": "X"}]}, {"code": "9.4.4", "title": "CTO Organization P.Os Approval:\n(Refer to the Interpretation of Authority Column for more details)", "description": "", "comments": "This covers all P.Os related to the manufacturing or relevant procurement related to R&D, Inventory/Stock, and P.Os against Sale orders within all CoE's, except for the P.Os against Sale orders under the Well Completion (this is addressed under item 9.4.5)", "function": "Supply Chain", "approvalChain": []}, {"code": "9.4.4.1", "title": "a) P.O Value > SAR 3,000,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only\nX2*: either one on the roles (Engineering Head or Technology Head) as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "CTO", "action": "X3", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.4.2", "title": "b) SAR 375,000 < P.O Value ≤ SAR 3,000,000", "description": "", "comments": "X2*: either one on the roles (Engineering Head or Technology Head) as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CTO", "action": "X3", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}]}, {"code": "9.4.4.3", "title": "c) SAR 105,000 < P.O Value ≤ SAR 375,000", "description": "", "comments": "R2*: required for Cross-border service P.Os only\nX3*: either one on the roles (Engineering Head or Technology Head) as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "Technology Portfolio Head", "action": "X3*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X3*", "kind": "X"}]}, {"code": "9.4.4.4", "title": "d) P.O Value ≤ SAR 105,000", "description": "", "comments": "1. R2*: required for Cross-border service P.Os only\n2. For P.Os load distribution, Supply Chain may request special delegation for other roles within the function for approving P.Os at this bracket, subject to the Endorsement of Governance and CEO approval", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Tax Director", "action": "R2*", "kind": "R"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X3", "kind": "X"}]}, {"code": "9.4.5", "title": "P.Os Approval related to manufacturing/procurement activities under Well Completions covered by Sale Orders \n(Refer to the Interpretation of Authority Column for details)", "description": "", "comments": "", "function": "Contract & Procurement", "approvalChain": []}, {"code": "9.4.5.1", "title": "a)  P.O Value > SAR 5,625,000", "description": "", "comments": "", "function": "Manufacturing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "COO", "action": "X3", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1", "kind": "X"}]}, {"code": "9.4.5.2", "title": "b) SAR 562,500 < P.O Value ≤ SAR 5,625,000", "description": "", "comments": "", "function": "Manufacturing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X3", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1", "kind": "X"}]}, {"code": "9.4.5.3", "title": "c) P.O Value ≤ SAR 562,500", "description": "", "comments": "", "function": "Manufacturing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X1", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X3", "kind": "X"}]}, {"code": "9.5", "title": "Approval / Amendment and Signing Contract:", "description": "", "comments": "For any Confidentiality or Non- Disclosure Agreements/engagements with suppliers or service providers, refer to item 11.3.3 under Legal section of this DOA matrix", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.1", "title": "Committed Spend Vendor Contracts:", "description": "", "comments": "The determination of whether a contract/agreement or an engagement with a third party has any sort of spend commitment on TAQA is vested within TAQA Legal only. CPL is responsible to obtain Legal clearance for the determination of whether a contract is committed or not.", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.1.1", "title": "COO/EPF Organization Contracts:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.1.1.1", "title": "a) Annual Contract Value > SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates\nX3*: one role only to approve as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "COO", "action": "X3*", "kind": "X"}, {"role": "EPF", "action": "X3*", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.1.2", "title": "b) SAR 375,000 < Annual Contract Value ≤ SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates\nX3*: one role only to approve as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "COO", "action": "X3*", "kind": "X"}, {"role": "EPF", "action": "X3*", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.1.3", "title": "c) SAR 75,000 < Annual Contract Value ≤ SAR 375,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}, {"role": "Head of PSL", "action": "X3", "kind": "X"}]}, {"code": "9.5.1.1.4", "title": "d) Annual Contract Value ≤ SAR 75,000  (refer to the Interpretation for PSL applicability*)", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates\nX3*: Only for Slickline, Wireline, Inspection & Testing, and Well safety PSLs, the Head of PSL shall approve this bracket.", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Tax Director", "action": "R2", "kind": "R"}, {"role": "Head of PSL", "action": "X3*", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X3", "kind": "X"}]}, {"code": "9.5.1.2", "title": "Support Functions Contracts:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.1.2.1", "title": "a) Annual Contract Value > SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X3", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.2.2", "title": "b) SAR 375,000 < Annual Contract Value ≤ SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X3", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.2.3", "title": "c) SAR 75,000 < Annual Contract Value ≤ SAR 375,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Support Function Head", "action": "X3", "kind": "X"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "Group Financial Controller", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.2.4", "title": "d) Annual Contract Value ≤ SAR 75,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates\nX3*: Country manager to approve the contract if there is no Department Head in the country", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Tax Director", "action": "R2", "kind": "R"}, {"role": "Country Manager", "action": "X3*", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "Support Dept Head", "action": "X3", "kind": "X"}]}, {"code": "9.5.1.3", "title": "CTO Organization Contracts:", "description": "", "comments": "", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.1.3.1", "title": "a) Annual Contract Value > SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X4", "kind": "X"}, {"role": "CFO", "action": "X2", "kind": "X"}, {"role": "CTO", "action": "X3", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.3.2", "title": "b) SAR 375,000 < Annual Contract Value ≤ SAR 3,000,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CTO", "action": "X3", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}]}, {"code": "9.5.1.3.3", "title": "c) SAR 75,000 < Annual Contract Value ≤ SAR 375,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates\nX3*: either of the two roles is required as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "VP Supply Chain", "action": "X1", "kind": "X"}, {"role": "FP&A Director", "action": "X2", "kind": "X"}, {"role": "Tax Director", "action": "R2", "kind": "R"}, {"role": "Technology Portfolio Head", "action": "X3*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X3*", "kind": "X"}]}, {"code": "9.5.1.3.4", "title": "d) Annual Contract Value ≤ SAR 75,000", "description": "", "comments": "E1*: Required if the contract/agreement is not on TAQA legal approved templates", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Tax Director", "action": "R2", "kind": "R"}, {"role": "PSL/EPF Finance Controller", "action": "X2", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X3", "kind": "X"}]}, {"code": "9.5.2", "title": "Un-Committed Spend Vendor Contracts:", "description": "", "comments": "1. The determination of whether a contract/agreement or an engagement with a third party has any sort of spend commitment on TAQA is vested within TAQA Legal only. Supply Chain is responsible to obtain Legal clearance for the determination of whether a contract is committed or not.\n\n2. For any Confidentiality or Non- Disclosure Agreements/engagements with suppliers or service providers, refer to item 11.3.3 under Legal section of this DOA matrix", "function": "Supply Chain", "approvalChain": []}, {"code": "9.5.2.1", "title": "All un-committed Contracts/Agreements such as MSA's, Price list agreements,….etc.", "description": "", "comments": "1. All contracts and agreements are reviewed and determined by Legal to whether the contract/agreement carries any  commitment to TAQA.\n2. Any un-committed contract/agreement with tenor exceeding 1 year shall undergo annual market price benchmarking by Supply Chain to ensure fair pricing\n3. Any P.O or execution under these contracts/agreements shall be in accordance with this DOA as applicable.\n4. X1*: only of  the three roles as applicable\n5. E1*: only one of the two roles as applicable", "function": "Supply Chain", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "R1", "kind": "R"}, {"role": "Tax Director", "action": "R1", "kind": "R"}, {"role": "Country Manager", "action": "X3*", "kind": "X"}, {"role": "Country Finance Lead", "action": "X2*", "kind": "X"}, {"role": "PSL/EPF Finance Controller", "action": "X2*", "kind": "X"}, {"role": "Procurement & Sourcing Director", "action": "X1", "kind": "X"}, {"role": "Support Dept Head", "action": "X3*", "kind": "X"}, {"role": "Manufacturing/Eng Manager", "action": "X3*", "kind": "X"}, {"role": "PSL/EPF Director", "action": "X3*", "kind": "X"}]}, {"code": "10", "title": "HUMAN RESOURCES", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.1", "title": "Org. Structure", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.1.1", "title": "Structure change in N-1 & N-2 functions, including addition & deletion", "description": "", "comments": "1- N-1 & N-2 relative to the CEO of the entity (TAQA or its wholly owned company)\n2- (E2*) Risk and sustainability Committee will be responsible only for endorsement of risk management function structure, and Audit Committee  will be responsible for endorsement of Internal Audit and Compliance function structure, whereas NRC will be responsible for other functions.", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "ExCom", "action": "E2*", "kind": "E"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "Audit Committee", "action": "E2*", "kind": "E"}, {"role": "Risk & Sustainability", "action": "E2*", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.1.2", "title": "Structure change in  N-3 functions, including addition & deletion", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E3", "kind": "E"}, {"role": "Corporate Services", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.1.3", "title": "Structure change in below N-3 functions, including addition & deletion", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2", "title": "Manpower Requisition", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.2.1", "title": "Direct Manpower Requisition (Below Grade 17) – Budgeted", "description": "", "comments": "X1*: only one role to approve as applicable", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.2.2", "title": "Direct Manpower Requisition  (Below Grade 17)– Un-Budgeted:", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.2.2.1", "title": "> 5% of function/SL approved manpower budget", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2.2.2", "title": "≤ 5% of function/SL approved manpower budget", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2.3", "title": "Head of Internal Audit", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "Audit Committee", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2.4", "title": "Supplementary Manpower Requisition – Budgeted", "description": "", "comments": "X1*: only one role to approve as applicable", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.2.5", "title": "Supplementary Manpower Requisition - Unbudgeted:", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.2.5.1", "title": "> 5% of function/SL approved manpower budget", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E4", "kind": "E"}, {"role": "CEO", "action": "E4", "kind": "E"}, {"role": "CFO", "action": "E3", "kind": "E"}, {"role": "Corporate Services", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2.5.2", "title": "≤ 5% of function/SL approved manpower budget", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E3", "kind": "E"}, {"role": "Corporate Services", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.2.6", "title": "Consultant Requisition (Individuals as consultants)", "description": "", "comments": "This covers hiring or entering an agreement with individuals as consultants", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CEO", "action": "R5", "kind": "R"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.3", "title": "Recruitment", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.3.1", "title": "CEO, and all positions on Grade 17 & above", "description": "", "comments": "Including Compensation & Benefits", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.3.2", "title": "Grade 16 and below:", "description": "", "comments": "1. Including Compensation & Benefits within TAQA approved compensation framework/policy and approved Budget", "function": "Human Recourses", "approvalChain": []}, {"code": "10.3.2.1", "title": "Grades 16 & 15", "description": "", "comments": "X2: NRC approval required for exception on Compensation & Benefits.", "function": "Human Recourses", "approvalChain": [{"role": "NRC", "action": "X*", "kind": "X"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.3.2.2", "title": "Grades from 10 to 14", "description": "", "comments": "X2: NRC approval required for exception on Compensation & Benefits.", "function": "Human Recourses", "approvalChain": [{"role": "NRC", "action": "X*", "kind": "X"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.3.2.3", "title": "Grades 9 and below", "description": "", "comments": "X1*: only one role to approve as applicable\nX2: NRC approval required for exception on Compensation & Benefits.", "function": "Human Recourses", "approvalChain": [{"role": "NRC", "action": "X*", "kind": "X"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.4", "title": "Employment Offer:", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.4.1", "title": "Employment Offer issuance and sign off", "description": "", "comments": "1. Within the approved recruitment compensation & benefits (Item 10.3)\n2. The delegation of this authority is aligned with the respective activity and the highest delegation role under item 10.3.", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}]}, {"code": "10.4.2", "title": "Extension in probation period", "description": "", "comments": "X1*: the approver of this item shall be the same recruitment approver (or his delegate) as per item 10.3 of this DOA", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1*", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1*", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.5", "title": "Transfers & Assignments", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.5.1", "title": "Grades 17 and above", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "CEO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R2", "kind": "R"}]}, {"code": "10.5.2", "title": "Grades 16 and below:", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.5.2.1", "title": "a) Transfers & Assignments within the function/PSL", "description": "", "comments": "X1*: only one role to approve as applicable", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.5.2.2", "title": "b) Transfers & Assignments from function to function or PSL to PSL", "description": "", "comments": "X1*: Both function heads (sending and receiving) shall approve", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.6", "title": "Job Evaluation", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.6.1", "title": "a) CEO and N-1", "description": "", "comments": "", "function": "NRC Committee", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "10.6.2", "title": "b) All Others", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "X1", "kind": "X"}]}, {"code": "10.7", "title": "Total Rewards", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.7.1", "title": "Approval and amendment of new Salary Structure, Allowances & Benefits, based on market competitiveness", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.2", "title": "Short Term Incentives (STI):", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.7.2.1", "title": "Approval of Annual Merit increase and Bonus (STI) Budget and list by names of grade 17 and above", "description": "", "comments": "E1*: TAQA CEO endorsement is not applicable for TAQA CEO participation", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.2.2", "title": "Approval of Annual Merit increase and Bonus (STI) Budget for grades 16 and below", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.2.3", "title": "Approval of Unbudgeted Annual Merit increase and Bonus (STI)", "description": "", "comments": "R1*: required only if the approval request for a specific case (employee)", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R4", "kind": "R"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1*", "kind": "R"}, {"role": "VP HR", "action": "R2", "kind": "R"}]}, {"code": "10.7.3", "title": "Long Term Incentives (LTI):", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.7.3.1", "title": "Approval of Long Term Incentives Budget", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R3", "kind": "R"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.3.2", "title": "Approval of LTI Participation list", "description": "", "comments": "E1*: TAQA CEO endorsement is not applicable for TAQA CEO participation", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.3.3", "title": "Approval of LTI KPIs", "description": "", "comments": "E1*: TAQA CEO endorsement is not applicable for TAQA CEO KPIs approval", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "Corporate Services", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.4", "title": "Annual Merit, STI & LTI Payout", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.5", "title": "Salary adjustment for CEO, Grade 17 and above", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "10.7.6", "title": "Salary adjustment  for all other positions and grades (within approved budget)", "description": "", "comments": "Within both approved budget and approved salary structure", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R", "kind": "R"}, {"role": "Corporate Services", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.7.7", "title": "Market Premium Application for Grade 17 and above", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R2", "kind": "R"}]}, {"code": "10.7.8", "title": "Market Premium Application for Grade 16 and below", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R2", "kind": "R"}]}, {"code": "10.8", "title": "Leaves", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.8.1", "title": "TAQA CEO", "description": "", "comments": "X*: CEO leaves are approved by BOD Chairman", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1*", "kind": "X"}]}, {"code": "10.8.2", "title": "Leaves (as per HR policy)", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.8.2.1", "title": "b) N-1", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}]}, {"code": "10.8.2.2", "title": "c) N-2 and Below", "description": "", "comments": "This authority is cascaded down to the direct line manager as per HR policies and process", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "10.8.3", "title": "Authorized Unpaid Leave:", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": []}, {"code": "10.8.3.1", "title": "a) > 60 days", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E2", "kind": "E"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}]}, {"code": "10.8.3.2", "title": "b) ≤ 60 days", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "X1", "kind": "X"}]}, {"code": "10.9", "title": "Business & Training Travel & Work Assignment", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.9.1", "title": "In-Kingdom Travel Request", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.9.1.1", "title": "a) TAQA CEO (Please refer to interpretation)", "description": "", "comments": "1- CEO's expense reports to be signed by EVP Corporate Services. (X*) BOD Chairman to approve CEO's Travel request.  Travel  Expenses will be approved by Corporate Services VP if within policy. BOD Chairman will approve expenses above policy limits.", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1*", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "10.9.1.2", "title": "b) N-1", "description": "", "comments": "", "function": "End user of all functions", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.9.1.3", "title": "c) N-2 and Below", "description": "", "comments": "This authority is cascaded down to the direct line manager as per HR policies and process", "function": "End user of all functions", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.9.2", "title": "Out-of-Kingdom Travel Request", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.9.2.1", "title": "a) TAQA CEO (Please refer to interpretation)", "description": "", "comments": "1- CEO's expense reports to be signed by EVP shared services. (X*) BOD Chairman to approve CEO's Travel request.  Travel  Expenses will be approved by Corporate Services VP if within policy. BOD Chairman will approve expenses above policy limits.", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1*", "kind": "X"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}]}, {"code": "10.9.2.2", "title": "b) N-1", "description": "", "comments": "", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}]}, {"code": "10.9.2.3", "title": "c) N-2 and Below", "description": "", "comments": "This authority is cascaded down to the direct line manager as per HR policies and process", "function": "End user of all functions", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.9.3", "title": "Policy Exception (Tickets. Vehicles, Accommodation)", "description": "", "comments": "", "function": "End user of all functions", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}]}, {"code": "10.1", "title": "Termination and acceptance of Resignation", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.10.1", "title": "Termination / Acceptance of Resignation of CEO", "description": "", "comments": "1- I*: to be initiated on the request of BoD or NRC  in case of termination.\n2- E1*: Legal (in case of Termination)", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "I*", "kind": "I"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}]}, {"code": "10.10.2", "title": "Termination / Acceptance of Resignation of grade 17 and above", "description": "", "comments": "E1*: Legal (in case of Termination)", "function": "Human Recourses", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R3", "kind": "R"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}, {"role": "VP HR", "action": "R2", "kind": "R"}]}, {"code": "10.10.3", "title": "Termination / Acceptance of Resignation of grades 16 - 13", "description": "", "comments": "E1*: Required in case of Termination only", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "X2", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.10.4", "title": "Termination / Acceptance of Resignation of grade 12 and below", "description": "", "comments": "1. X1*: only one role to approve as applicable\n2. E1*: Required in case of Termination only", "function": "Human Recourses", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "E1*", "kind": "E"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.10.5", "title": "Appointment & Termination Of Chief Audit Executive", "description": "", "comments": "", "function": "Audit Committee", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "Audit Committee", "action": "I", "kind": "I"}, {"role": "CEO", "action": "N", "kind": "N"}]}, {"code": "10.11", "title": "Annual appraisal", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.11.1", "title": "Performance evaluation and approval of and/or changes to Key Performance Indicators (KPIs) of Entity's CEO and for grade 17 and above.", "description": "", "comments": "(E1*) TAQA CEO endorsement is not applicable on TAQA CEO evaluation and KPIs approval/changes", "function": "CEO", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "10.11.2", "title": "Performance evaluation and approval of and/or changes to Key Performance Indicators (KPIs) for grade 16 and below.", "description": "", "comments": "X1*: only one role to approve as applicable", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.12", "title": "Work Schedule / Overtime / Field Allowances", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.12.1", "title": "Work Schedule:", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.12.1.1", "title": "a) Setting / changing Operational Calendar", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "10.12.1.2", "title": "b) Setting/changing working hours", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "10.12.1.3", "title": "c) Setting shifts / different working hours", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "10.12.2", "title": "Overtime/Compensatory Days Off:", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.12.2.1", "title": "a) Overtime Grade 04-12", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "HR Business Partner", "action": "R1", "kind": "R"}, {"role": "PSL/EPF Director", "action": "X1", "kind": "X"}]}, {"code": "10.12.2.2", "title": "b) Compensatory Days Off (Grade 13 above)", "description": "", "comments": "N*: notified as applicable only \nX1*: only one role to approve as applicable", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.12.3", "title": "Allowances/Advances:", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.12.3.1", "title": "a) Time Sheet for manhours, Job Bonus, …etc.", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "HR Business Partner", "action": "R1", "kind": "R"}, {"role": "PSL/EPF Director", "action": "X1", "kind": "X"}]}, {"code": "10.12.3.2", "title": "b) Time Sheet for Job Bonus (Position not in the approved job bonus structure)", "description": "", "comments": "N*: notified as applicable only", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1", "kind": "X"}]}, {"code": "10.12.3.3", "title": "c) Other Field Allowances such as  Shift Allowance, Trip Bonus, etc.", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "HR Business Partner", "action": "R1", "kind": "R"}, {"role": "PSL/EPF Director", "action": "X1", "kind": "X"}]}, {"code": "10.12.3.4", "title": "d) Housing Advance (in line with policy)", "description": "", "comments": "1. In accordance with HR policy\n2. X1*: only one role to approve as applicable", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "X2", "kind": "X"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}, {"role": "HR Business Partner", "action": "R1", "kind": "R"}]}, {"code": "10.13", "title": "Promotions (Budgeted only)", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.13.1", "title": "Grade 17 and above", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}]}, {"code": "10.13.2", "title": "Grade 16 and below", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}]}, {"code": "10.13.2.1", "title": "Promotions from Grades 15 &14", "description": "", "comments": "N*: notified as applicable only", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X3", "kind": "X"}, {"role": "Corporate Services", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "E1", "kind": "E"}, {"role": "Head of PSL", "action": "N*", "kind": "N"}]}, {"code": "10.13.2.2", "title": "Promotions from Grades  9  to 13", "description": "", "comments": "N*: notified as applicable only", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "Head of PSL", "action": "N*", "kind": "N"}]}, {"code": "10.13.2.3", "title": "Promotions from all grades below 9", "description": "", "comments": "X1*: only one role to approve as applicable", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Support Function Head", "action": "X1*", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Head of PSL", "action": "X1*", "kind": "X"}, {"role": "Technology Portfolio Head", "action": "X1*", "kind": "X"}, {"role": "ENG/TECH Head", "action": "X1*", "kind": "X"}]}, {"code": "10.14", "title": "Learning & Development", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.14.1", "title": "Individual Development Plan for Entity's CEO and for grade 17 and above", "description": "", "comments": "E1*: TAQA CEO endorsement is not applicable on TAQA CEO development plan", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1*", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "10.14.2", "title": "Individual Development Plan for grade 16 and below", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "X2", "kind": "X"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}]}, {"code": "10.14.3", "title": "Annual Learning and Development Plan", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "E1", "kind": "E"}]}, {"code": "10.14.4", "title": "L&D Ad hoc request", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X2", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "E1", "kind": "E"}]}, {"code": "10.14.5", "title": "L&D Expenses", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "R1", "kind": "R"}, {"role": "Group Financial Controller", "action": "X1", "kind": "X"}]}, {"code": "10.15", "title": "Payroll & Employees Benefits", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.15.1", "title": "Processing and approving monthly Payroll", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "VP HR", "action": "X2", "kind": "X"}, {"role": "Country Payroll", "action": "X1", "kind": "X"}]}, {"code": "10.15.2", "title": "EOSB and Final settlement", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}]}, {"code": "10.15.2.1", "title": "a) For all countries", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "HR Business Partner", "action": "X2", "kind": "X"}, {"role": "Country Payroll", "action": "X1", "kind": "X"}]}, {"code": "10.15.2.2", "title": "b) For Corporate", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "VP HR", "action": "X1", "kind": "X"}, {"role": "Country Payroll", "action": "E1", "kind": "E"}]}, {"code": "10.16", "title": "Succession Planning", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.16.1", "title": "Succession Planning for TAQA CEO and for grade 17 and above", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "10.16.2", "title": "Succession Planning for grade 16 and below", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}]}, {"code": "10.17", "title": "Disciplinary Action/Investigation", "description": "", "comments": "", "function": "Human Resources", "approvalChain": []}, {"code": "10.17.1", "title": "Disciplinary Action/Investigation over TAQA CEO and CEO's N-1", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "NRC", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E1", "kind": "E"}]}, {"code": "10.17.2", "title": "Disciplinary Action/Investigation as per labor law", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "X1", "kind": "X"}, {"role": "HR Business Partner", "action": "E1", "kind": "E"}]}, {"code": "10.17.3", "title": "Impose penalties as per labor law", "description": "", "comments": "", "function": "Human Resources", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "VP HR", "action": "X1", "kind": "X"}, {"role": "HR Business Partner", "action": "E1", "kind": "E"}]}, {"code": "11", "title": "LEGAL MATTERS", "description": "", "comments": "", "function": "Legal Matters", "approvalChain": []}, {"code": "11.1", "title": "Appointment of Legal Advisors & Power of Attorney", "description": "", "comments": "", "function": "Legal Matters", "approvalChain": []}, {"code": "11.1.1", "title": "Appointment of external Legal Advisor", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "E1", "kind": "E"}]}, {"code": "11.1.2", "title": "Executing Power of Attorney on behalf of TAQA or its Wholly owned entities", "description": "", "comments": "N*: Informing TAQA BOD on execution power of attorney on behalf of TAQA only.", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "N*", "kind": "N"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2", "title": "Litigation & Arbitration", "description": "", "comments": "", "function": "Legal Matters", "approvalChain": []}, {"code": "11.2.1", "title": "Decision on dispute resolution approach – Arbitration or Litigation", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "E1", "kind": "E"}]}, {"code": "11.2.2", "title": "Litigation/arbitration management", "description": "", "comments": "Day-to-day decisions on case management", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "X1", "kind": "X"}]}, {"code": "11.2.3", "title": "Filing complains against penalties and fines issued by government authorities, regulatory bodies, financial institutions,…", "description": "", "comments": "1. This covers formal complains through the body’s complains systems and formal procedures only, such ZATCA,…etc.\n2. R1*: Respective CEO N-1 to which the penalty is applied to related to.", "function": "Business User", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "Corporate Services", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "R2", "kind": "R"}, {"role": "Respective CEO N-1", "action": "R1*", "kind": "R"}]}, {"code": "11.2.4", "title": "Initiation & Settlement of Local & Foreign lawsuit or arbitration (including appeal):", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.1", "title": "Disputes with Government authorities and Regulatory bodies", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.2", "title": "Disputes with Customers:", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.2.1", "title": "> SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "COO", "action": "R1", "kind": "R"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.2.2", "title": "≤ SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "COO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.3", "title": "Disputes with Business Partners", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "11.2.4.4", "title": "Disputes with Vendors:", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.4.1", "title": "> SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "11.2.4.4.2", "title": "SAR 500K ≤ and ≥ SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.4.3", "title": "< SAR 500K", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CFO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.5", "title": "Disputes with Insurers:", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.5.1", "title": "≥ SAR 10M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}]}, {"code": "11.2.4.5.2", "title": "< SAR 10M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "N", "kind": "N"}, {"role": "CFO", "action": "X1", "kind": "X"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.6", "title": "Disputes with Employees", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.6.1", "title": "≥ SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "11.2.4.6.2", "title": "SAR 300K > and ≤ SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.6.3", "title": "≤ SAR 300K", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "X1", "kind": "X"}, {"role": "Corporate Services", "action": "E1", "kind": "E"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.2.4.7", "title": "With other parties (other than the above categories)", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.2.4.7.1", "title": "> SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}]}, {"code": "11.2.4.7.2", "title": "≤ SAR 2M", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R1", "kind": "R"}]}, {"code": "11.3", "title": "Others", "description": "", "comments": "", "function": "Legal Matters", "approvalChain": []}, {"code": "11.3.1", "title": "Issuing legal notices asserting TAQA’s rights, and responding to legal notices:", "description": "", "comments": "", "function": "Legal", "approvalChain": []}, {"code": "11.3.1.1", "title": "a) Potential Dispute > SAR 1 Million", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "General Counsel", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "R1", "kind": "R"}]}, {"code": "11.3.1.2", "title": "b) Potential Dispute ≤ SAR 1 Million", "description": "", "comments": "", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1", "kind": "X"}]}, {"code": "11.3.2", "title": "Responding to routine/ non-routine legal inquiries or investigation requests from government", "description": "", "comments": "1. Responding to tax/zakat inquiries, investigations, requests from government or judicial authorities. involvement of Legal is required\n2. Relevant N-1 to endorse depending on functional relevance\n3. N*: CEO is notified on non-routine and investigation requests", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "N*", "kind": "N"}, {"role": "CFO", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "X1", "kind": "X"}, {"role": "Respective CEO N-1", "action": "E1*", "kind": "E"}]}, {"code": "11.3.3", "title": "Authorizing Confidentiality and Non-Disclosure Agreement engagement and sign off with third parties (all types of third parties, such as: clients, business partners, suppliers, service providers,….)", "description": "", "comments": "X1*: Delegable by the CEO N-1 to direct reportees subject to reportee not less than Director level. Such delegation shall be in written form, and in all cases, NDA's and any other confidentiality agreements always subject to Legal Endorsement.", "function": "Legal", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "General Counsel", "action": "E1", "kind": "E"}, {"role": "Respective CEO N-1", "action": "X1*", "kind": "X"}]}, {"code": "12", "title": "NBD & Marketing", "description": "", "comments": "", "function": "NBD & Marketing", "approvalChain": []}, {"code": "12.1", "title": "New Business Development (Within Approved budget)", "description": "", "comments": "", "function": "NBD & Marketing", "approvalChain": []}, {"code": "12.1.1", "title": "New Business Development Manual", "description": "", "comments": "", "function": "Commercial & Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Strategy & Corp Dev", "action": "R1", "kind": "R"}]}, {"code": "12.1.2", "title": "Assessment of new NBD opportunity (GO / No GO)", "description": "", "comments": "", "function": "Commercial & Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E2", "kind": "E"}, {"role": "Strategy & Corp Dev", "action": "E1", "kind": "E"}]}, {"code": "12.1.3", "title": "Marketing Plans", "description": "", "comments": "", "function": "Commercial & Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "12.1.4", "title": "Corporate advertising content and text (including product brochures, films, booklets, etc.]", "description": "", "comments": "", "function": "Commercial & Marketing", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Marketing & Commercial", "action": "X1", "kind": "X"}]}, {"code": "13", "title": "Corporate Communication", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": []}, {"code": "13.1", "title": "Internal Communication", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": []}, {"code": "13.1.1", "title": "Corporate announcements through CEO email", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Chief of Staff", "action": "X1", "kind": "X"}]}, {"code": "13.1.2", "title": "Mass Communications to subsidiaries and employees", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Chief of Staff", "action": "X1", "kind": "X"}]}, {"code": "13.2", "title": "External Communication", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": []}, {"code": "13.2.1", "title": "Social media/Digital communication manual", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Chief of Staff", "action": "X1", "kind": "X"}]}, {"code": "13.2.2", "title": "Approval on contents for social media posting and any mean of external content", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "Chief of Staff", "action": "X1", "kind": "X"}]}, {"code": "13.2.3", "title": "Approval of press releases and public statements", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "BOD", "action": "N", "kind": "N"}, {"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Chief of Staff", "action": "R1", "kind": "R"}, {"role": "General Counsel", "action": "R3", "kind": "R"}, {"role": "Marketing & Commercial", "action": "R2", "kind": "R"}]}, {"code": "13.3.", "title": "Events Management", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": []}, {"code": "13.3.1", "title": "Participation in unplanned corporate events, exhibitions, sponsorships, conferences, campaigns (Budgeted)", "description": "", "comments": "", "function": "Corporate Communication", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "Chief of Staff", "action": "E1", "kind": "E"}]}, {"code": "14", "title": "Other Investments", "description": "", "comments": "", "function": "Other Investments", "approvalChain": []}, {"code": "14.1", "title": "Budgeted value of expansions (CAPEX/Committed Opex Obligations) /New Projects", "description": "", "comments": "", "function": "Other Investments", "approvalChain": []}, {"code": "14.1.1", "title": "Approving TAQA Expansions / New Projects \n(within approved budget)", "description": "", "comments": "Any new R&D project and/or new facilities (including expansion of existing facilities).\n Endorsements and approvals should be in the form of a formal project review meeting and will not be granted by email circulation.", "function": "Other Investments", "approvalChain": []}, {"code": "14.1.1.1", "title": "a) > SAR 200M", "description": "", "comments": "", "function": "End User", "approvalChain": [{"role": "ExCom", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CEO", "action": "E2", "kind": "E"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "14.1.1.2", "title": "b)  ≤ SAR 200M", "description": "", "comments": "", "function": "End User", "approvalChain": [{"role": "CEO", "action": "X", "kind": "X"}, {"role": "CEO", "action": "X1", "kind": "X"}, {"role": "CFO", "action": "E1", "kind": "E"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}, {"code": "14.2", "title": "Aggregated unbudgeted value of expansions (CAPEX/Committed Opex Obligations) /New Projects", "description": "", "comments": "", "function": "Other Investments", "approvalChain": []}, {"code": "14.2.1", "title": "Approving TAQA Expansions / New Projects (unbudgeted)", "description": "", "comments": "", "function": "End User", "approvalChain": [{"role": "BOD", "action": "X1", "kind": "X"}, {"role": "CEO", "action": "E1", "kind": "E"}, {"role": "CFO", "action": "R2", "kind": "R"}, {"role": "Corporate Services", "action": "R1", "kind": "R"}]}]</script>
</head>
<body>
  <div id="root"></div>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    // TAQA Brand Colors
    const COLORS = {
      primary: '#006B6B',
      primaryLight: '#008585',
      primaryDark: '#005454',
      accent: '#E86A2C',
      accentLight: '#FF8243',
      success: '#10B981',
      warning: '#F59E0B',
      danger: '#EF4444',
      info: '#0EA5E9',
    };

    // Approval Chain Ordering - normalizeAndSortApprovers
    // Sort order: I (Initiate) → R (Review) → E (Endorse) → X (Approve)
    // Within each group: ascending numeric levels
    // EX is highest endorsement (level 10, after E9, before X)
    // '*' suffix ignored for sorting but kept in display
    // Sorting priority: I (Initiate) → R (Review) → E (Endorse) → X (Approve) → N (Notify - always last)
    const GROUP_PRIORITY = { 'I': 0, 'R': 1, 'E': 2, 'X': 3, 'N': 4 };

    function parseActionToken(action) {
      if (!action || typeof action !== 'string') {
        return { group: 'Z', level: 999, original: action || '', hasStar: false };
      }
      let normalized = action.replace(/\s+/g, '').toUpperCase();
      const original = normalized;
      const hasStar = normalized.includes('*');
      normalized = normalized.replace(/\*/g, '');
      if (normalized === 'EX') {
        return { group: 'E', level: 10, original: hasStar ? 'EX*' : 'EX', hasStar };
      }
      const match = normalized.match(/^([IREXN])(\d*)$/);
      if (!match) {
        const groupMatch = normalized.match(/^([A-Z])/);
        const numMatch = normalized.match(/(\d+)/);
        return {
          group: groupMatch ? groupMatch[1] : 'Z',
          level: numMatch ? parseInt(numMatch[1], 10) : 999,
          original: hasStar ? original : action.replace(/\s+/g, ''),
          hasStar
        };
      }
      const group = match[1];
      const levelStr = match[2];
      const level = levelStr ? parseInt(levelStr, 10) : 100;
      return {
        group,
        level,
        original: hasStar ? `${group}${levelStr || ''}*` : `${group}${levelStr || ''}`,
        hasStar
      };
    }

    function normalizeAndSortApprovers(approvers) {
      if (!approvers || !Array.isArray(approvers) || approvers.length === 0) {
        return [];
      }

      // Step 1: Parse each approver with token info
      const parsed = approvers.map((approver, originalIndex) => {
        const tokenInfo = parseActionToken(approver.action);
        return { ...approver, _parsed: tokenInfo, _originalIndex: originalIndex };
      });

      // Step 2: Deduplicate using normalized key (role + token)
      // Keep FIRST occurrence (stable)
      const seen = new Set();
      const deduped = parsed.filter(approver => {
        // Normalize role: trim, collapse whitespace, lowercase
        const normalizedRole = (approver.role || '').trim().replace(/\s+/g, ' ').toLowerCase();
        // Normalize token: uppercase, strip '*' for comparison only
        const normalizedToken = (approver._parsed.original || '').toUpperCase().replace(/\*/g, '');
        const key = normalizedRole + '|' + normalizedToken;

        if (seen.has(key)) {
          return false; // Duplicate - discard
        }
        seen.add(key);
        return true; // First occurrence - keep
      });

      // Step 3: Sort the deduped list
      deduped.sort((a, b) => {
        const aGroup = GROUP_PRIORITY[a._parsed.group] ?? 4;
        const bGroup = GROUP_PRIORITY[b._parsed.group] ?? 4;
        if (aGroup !== bGroup) return aGroup - bGroup;
        if (a._parsed.level !== b._parsed.level) return a._parsed.level - b._parsed.level;
        if (a._parsed.hasStar !== b._parsed.hasStar) return a._parsed.hasStar ? 1 : -1;
        return a._originalIndex - b._originalIndex;
      });

      // Step 4: Return cleaned result
      return deduped.map(approver => {
        const { _parsed, _originalIndex, ...rest } = approver;
        return { ...rest, action: _parsed.original };
      });
    }

    // Data quality diagnostics - runs once on load
    function validateDOAData(items) {
      if (!items || !Array.isArray(items)) return;

      const validTokenPattern = /^[IREXN]\d*\*?$/i;
      const issues = [];

      items.forEach(item => {
        if (!item.approvalChain || !Array.isArray(item.approvalChain)) return;

        // Check 1: Chain exists but parses to empty (no valid tokens)
        if (item.approvalChain.length > 0) {
          const validTokens = item.approvalChain.filter(a =>
            a.action && validTokenPattern.test(a.action.replace(/\s+/g, ''))
          );
          if (validTokens.length === 0) {
            issues.push({
              code: item.code,
              issue: 'chain_parses_empty',
              detail: `Chain has ${item.approvalChain.length} entries but no valid tokens`
            });
          }
        }

        // Check 2: Unrecognized tokens
        item.approvalChain.forEach(approver => {
          if (!approver.action) return;
          const normalized = approver.action.replace(/\s+/g, '').toUpperCase();
          if (!validTokenPattern.test(normalized) && normalized !== 'EX' && normalized !== 'EX*') {
            issues.push({
              code: item.code,
              issue: 'unrecognized_token',
              detail: `Role "${approver.role}" has unrecognized token "${approver.action}"`
            });
          }
        });

        // Check 3: Duplicate (role, token) pairs
        const seen = new Set();
        item.approvalChain.forEach(approver => {
          const key = `${approver.role}:${approver.action}`;
          if (seen.has(key)) {
            issues.push({
              code: item.code,
              issue: 'duplicate_pair',
              detail: `Duplicate (role, token) pair: ${key}`
            });
          }
          seen.add(key);
        });
      });

      // Log summary
      if (issues.length > 0) {
        console.warn('[DOA Data Quality] Found', issues.length, 'issues:');
        issues.forEach(issue => {
          console.warn(`  [${issue.issue}] Code ${issue.code}: ${issue.detail}`);
        });
      } else {
        console.log('[DOA Data Quality] All approval chains validated successfully');
      }

      return issues;
    }

    // Theme configurations
    const themes = {
      dark: {
        name: 'dark',
        pageBg: COLORS.primary,
        cardBg: 'rgba(0, 85, 85, 0.6)',
        cardBorder: 'rgba(0, 180, 180, 0.4)',
        inputBg: 'rgba(0, 50, 50, 0.7)',
        inputBorder: 'rgba(0, 180, 180, 0.5)',
        text: '#FFFFFF',
        textMuted: 'rgba(255, 255, 255, 0.9)',
        textSubtle: 'rgba(255, 255, 255, 0.75)',
        headerBg: 'rgba(0, 70, 70, 0.95)',
        tagBg: 'rgba(0, 120, 120, 0.5)',
        modalBg: '#004848',
        successBg: 'rgba(16, 185, 129, 0.25)',
        successText: '#86EFAC',
        warningBg: 'rgba(245, 158, 11, 0.25)',
        warningText: '#FDE047',
        dangerBg: 'rgba(239, 68, 68, 0.25)',
        dangerText: '#FCA5A5',
        infoBg: 'rgba(14, 165, 233, 0.25)',
        infoText: '#93C5FD',
      },
      light: {
        name: 'light',
        pageBg: '#F3F4F6',
        cardBg: '#FFFFFF',
        cardBorder: '#E5E7EB',
        inputBg: '#FFFFFF',
        inputBorder: '#D1D5DB',
        text: '#111827',
        textMuted: '#4B5563',
        textSubtle: '#6B7280',
        headerBg: '#FFFFFF',
        tagBg: '#F3F4F6',
        modalBg: '#FFFFFF',
        successBg: 'rgba(16, 185, 129, 0.1)',
        successText: '#059669',
        warningBg: 'rgba(245, 158, 11, 0.1)',
        warningText: '#D97706',
        dangerBg: 'rgba(239, 68, 68, 0.1)',
        dangerText: '#DC2626',
        infoBg: 'rgba(14, 165, 233, 0.1)',
        infoText: '#0284C7',
      }
    };

    // Default Safe Countries
    const DEFAULT_SAFE_COUNTRIES = [
      'Bahrain', 'Bangladesh', 'Egypt', 'India', 'Iraq - Kurdistan', 'Iraq - South', 'Kuwait', 'Libya',
      'Oman', 'Pakistan', 'Qatar', 'Saudi Arabia', 'Turkey', 'United Arab Emirates'
    ];

    const DEFAULT_SPECIAL_COUNTRIES = [
      'Algeria', 'Egypt', 'Iraq - South', 'Libya', 'Pakistan'
    ];

    // All Countries
    const ALL_COUNTRIES = [
      'Afghanistan', 'Albania', 'Algeria', 'Angola', 'Argentina', 'Armenia', 'Australia',
      'Austria', 'Azerbaijan', 'Bahrain', 'Bangladesh', 'Belarus', 'Belgium', 'Bolivia',
      'Bosnia and Herzegovina', 'Brazil', 'Brunei', 'Bulgaria', 'Cameroon', 'Canada',
      'Chad', 'Chile', 'China', 'Colombia', 'Congo', 'Croatia', 'Cuba', 'Cyprus',
      'Czech Republic', 'Denmark', 'Ecuador', 'Egypt', 'Equatorial Guinea', 'Estonia',
      'Ethiopia', 'Finland', 'France', 'Gabon', 'Georgia', 'Germany', 'Ghana', 'Greece',
      'Hungary', 'India', 'Indonesia', 'Iran', 'Iraq - Kurdistan', 'Iraq - South', 'Ireland', 'Israel', 'Italy',
      'Ivory Coast', 'Japan', 'Jordan', 'Kazakhstan', 'Kenya', 'Kuwait', 'Kyrgyzstan',
      'Latvia', 'Lebanon', 'Libya', 'Lithuania', 'Luxembourg', 'Malaysia', 'Mali',
      'Mauritania', 'Mexico', 'Mongolia', 'Morocco', 'Mozambique', 'Myanmar', 'Netherlands',
      'New Zealand', 'Niger', 'Nigeria', 'North Korea', 'Norway', 'Oman', 'Pakistan',
      'Panama', 'Papua New Guinea', 'Peru', 'Philippines', 'Poland', 'Portugal', 'Qatar',
      'Romania', 'Russia', 'Saudi Arabia', 'Senegal', 'Serbia', 'Singapore', 'Slovakia',
      'Slovenia', 'Somalia', 'South Africa', 'South Korea', 'South Sudan', 'Spain',
      'Sri Lanka', 'Sudan', 'Sweden', 'Switzerland', 'Syria', 'Taiwan', 'Tajikistan',
      'Tanzania', 'Thailand', 'Trinidad and Tobago', 'Tunisia', 'Turkey', 'Turkmenistan',
      'Uganda', 'Ukraine', 'United Arab Emirates', 'United Kingdom', 'United States',
      'Uzbekistan', 'Venezuela', 'Vietnam', 'Yemen', 'Zambia', 'Zimbabwe'
    ];

    // DOA Data with Non-binding RFQ thresholds added
    const DOA_DATA = {
      categories: {
        1: "Corporate Organisation & Structure",
        2: "Board of Directors",
        3: "Strategies, Plans & Policies",
        4: "Commercial & Marketing",
        5: "Human Resources",
        6: "Treasury",
        7: "Finance & Accounting",
        8: "Tax",
        9: "Supply Chain",
        10: "QHSE",
        11: "Legal & Compliance",
        12: "Technology",
        13: "Risk & Insurance",
        14: "Internal Audit"
      },
      
      roles: [
        'General Assembly', 'BOD', 'ExCom', 'NRC', 'Audit Committee', 'Risk & Sustainability',
        'CEO', 'COO', 'CFO', 'CTO', 'EPF',
        'Strategy & Corp Dev', 'Corporate Services', 'Chief of Staff', 'General Counsel',
        'Marketing & Commercial', 'QHSE', 'Internal Audit',
        'VP HR', 'VP GRC', 'VP Supply Chain', 'Group Financial Controller',
        'FP&A Director', 'Tax Director', 'Treasury Director',
        'Commercial Director', 'VP Geographies', 'Head of PSL',
        'Country Manager', 'Country Finance Lead', 'PSL/EPF Director',
        'Procurement & Sourcing Director', 'Supply Chain Ops Director',
        'HR Business Partner', 'Support Dept Head', 'Manufacturing/Eng Manager'
      ],

      items: [
        { code: "1.1.1", description: "Establish By-Laws/ Articles of Association and JV Agreements", applies_to: "Wholly Owned", category_id: 1, business_owner: "Corporate Development", approvers: { "BOD": "X1", "CEO": "E1", "Strategy & Corp Dev": "R1", "General Counsel": "R2", "VP GRC": "R1" }},
        { code: "1.2.1.1", description: "Amendment of TAQA's By-laws", applies_to: "TAQA", category_id: 1, business_owner: "Legal", approvers: { "General Assembly": "X1", "BOD": "E2", "CEO": "E1", "Strategy & Corp Dev": "R1", "General Counsel": "R2" }},
        { code: "1.2.1.1.1", description: "Capital increase/decrease, change of Head Office and Objectives", applies_to: "Wholly Owned", category_id: 1, business_owner: "Corporate Governance", interpretation: "X2*: Board approval required only for changing company objective if it is change in core business", approvers: { "BOD": "X2*", "ExCom": "X1", "CEO": "E1", "CFO": "R2", "General Counsel": "R1" }},
        { code: "1.2.1.1.2", description: "Other By-law amendments", applies_to: "Wholly Owned", category_id: 1, business_owner: "Corporate Governance", delegable: "Yes", approvers: { "CEO": "X", "Strategy & Corp Dev": "R1", "General Counsel": "R2", "VP GRC": "R1" }},
        { code: "1.3.1.1", description: "Incorporation of Branch Offices of TAQA", applies_to: "TAQA", category_id: 1, business_owner: "Legal", interpretation: "In accordance with TAQA Bylaw - Article 5", approvers: { "BOD": "X1", "ExCom": "E2", "CEO": "E1", "CFO": "R2", "General Counsel": "R2" }},
        { code: "3.1.1", description: "Approve TAQA Strategy", applies_to: "TAQA", category_id: 3, business_owner: "Strategy", approvers: { "BOD": "X1", "CEO": "E1", "Strategy & Corp Dev": "R1" }},
        { code: "3.2.1", description: "Approve Annual Business Plan & Budget", applies_to: "TAQA", category_id: 3, business_owner: "Finance", approvers: { "BOD": "X1", "CEO": "E1", "CFO": "R1" }},
        { code: "4.1.1", description: "Customer Commitments in High-Risk Market", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", interpretation: "High Risk Market determined by GRC Risk Function. Review committee: CEO, CFO, COO, Commercial & Marketing, General Counsel", approvers: { "BOD": "X1", "CEO": "E4*", "COO": "E1*", "EPF": "E1*", "CFO": "E3*", "General Counsel": "E2*", "Marketing & Commercial": "E1" }},
        { code: "4.2.1.1", description: "Non-binding RFQs/RFPs/Quotes > SAR 50 Million", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", delegable: "Yes", approvers: { "CEO": "X", "COO": "X1", "CFO": "X2", "Marketing & Commercial": "X3" }},
        { code: "4.2.1.2", description: "SAR 18.75M < Non-binding RFQs/RFPs/Quotes ≤ SAR 50 Million", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", delegable: "Yes", approvers: { "CEO": "X", "Head of PSL": "X1", "FP&A Director": "X2", "Marketing & Commercial": "X3" }},
        { code: "4.2.1.3", description: "Non-binding RFQs/RFPs/Quotes ≤ SAR 18.75 Million", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", delegable: "Yes", approvers: { "CEO": "X", "PSL/EPF Director": "X1", "PSL/CoE/EPF Finance Controller": "X2" }},
        { code: "4.2.2.1", description: "Total Contract Value > SAR 200 Million (regardless of Capex)", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "BOD": "X1", "CEO": "E4", "COO": "E1*", "EPF": "E1*", "CFO": "E3", "General Counsel": "R2", "Marketing & Commercial": "E1" }},
        { code: "4.2.2.2", description: "SAR 50M < Total Contract Value ≤ SAR 200M (regardless of Capex)", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "ExCom": "X1", "CEO": "E4", "COO": "E1*", "EPF": "E1*", "CFO": "E3", "General Counsel": "R2", "Marketing & Commercial": "E1" }},
        { code: "4.2.2.3", description: "Any Contract with Capex > SAR 10 Million", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "ExCom": "X1", "CEO": "E3", "COO": "E1*", "EPF": "E1*", "CFO": "E2", "Marketing & Commercial": "E1" }},
        { code: "4.2.3.1.1", description: "SAR 30M < TCV ≤ SAR 50M regardless of Capex; or Capex SAR 5-10M", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "CEO": "X4", "COO": "X3", "CFO": "X2", "Marketing & Commercial": "X1" }},
        { code: "4.2.3.1.2", description: "SAR 5M < TCV ≤ SAR 30M with Capex up to 5M; or TCV < 5M with Capex up to 5M", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "CEO": "X", "COO": "X3", "CFO": "X2", "Marketing & Commercial": "X1" }},
        { code: "4.2.3.1.3", description: "TCV ≤ SAR 5M with/without Capex up to 10% TCV (fully loaded Operating Profit with net income > 10%)", applies_to: "", category_id: 4, business_owner: "Commercial and Marketing", approvers: { "CEO": "X", "Head of PSL": "X1", "FP&A Director": "X2", "Marketing & Commercial": "X3" }},
        { code: "4.2.3.2.1", description: "Direct Sales: All Contracts with Gross Margin <40% regardless of Contract Value", applies_to: "", category_id: 4, business_owner: "COO", delegable: "Yes", approvers: { "CEO": "X", "COO": "X3", "CFO": "X2", "Marketing & Commercial": "X1" }},
        { code: "4.2.3.2.2", description: "Direct Sales: SAR 30M < TCV ≤ 50M (GM ≥40%)", applies_to: "", category_id: 4, business_owner: "COO", delegable: "Yes", approvers: { "CEO": "X", "COO": "X3", "CFO": "X2", "Marketing & Commercial": "X1" }},
        { code: "4.2.3.2.3", description: "Direct Sales: SAR 18.75M < TCV ≤ SAR 30M (GM ≥40%)", applies_to: "", category_id: 4, business_owner: "COO", delegable: "Yes", approvers: { "CEO": "X", "Head of PSL": "X1", "FP&A Director": "X2", "Marketing & Commercial": "X3" }},
        { code: "4.2.3.2.4", description: "Direct Sales: SAR 1.875M < TCV ≤ SAR 18.75M (GM ≥40%)", applies_to: "", category_id: 4, business_owner: "COO", approvers: { "Head of PSL": "X2", "PSL/CoE/EPF Finance Controller": "X1" }},
        { code: "4.2.3.2.5", description: "Direct Sales: TCV ≤ SAR 1.875M (GM ≥40%)", applies_to: "", category_id: 4, business_owner: "COO", approvers: { "PSL/CoE/EPF Finance Controller": "X1", "PSL/EPF Director": "X2" }},
        { code: "4.2.3.3.1", description: "EPF: TCV up to SAR 50M with Capex up to 10M", applies_to: "", category_id: 4, business_owner: "EPF Head", approvers: { "CEO": "X4", "EPF": "X2", "CFO": "X3", "Marketing & Commercial": "X1" }},
        { code: "5.1.1", description: "Approve Organization Structure Changes", applies_to: "TAQA", category_id: 5, business_owner: "HR", approvers: { "BOD": "X1", "CEO": "E1", "VP HR": "R1" }},
        { code: "5.2.1", description: "Approve Compensation & Benefits Policy", applies_to: "TAQA", category_id: 5, business_owner: "HR", approvers: { "NRC": "X1", "CEO": "E1", "VP HR": "R1" }},
        { code: "6.1.1", description: "Open/Close Bank Accounts", applies_to: "", category_id: 6, business_owner: "Treasury", approvers: { "CEO": "X", "CFO": "E1", "Treasury Director": "R1" }},
        { code: "6.2.1", description: "Approve Borrowing/Financing > SAR 100M", applies_to: "", category_id: 6, business_owner: "Treasury", approvers: { "BOD": "X1", "CEO": "E1", "CFO": "R1", "Treasury Director": "R2" }},
        { code: "7.1.1", description: "Approve Annual Financial Statements", applies_to: "TAQA", category_id: 7, business_owner: "Finance", approvers: { "Audit Committee": "E1", "BOD": "X1", "CEO": "E2", "CFO": "R1" }},
        { code: "7.2.1", description: "Write-off Bad Debts > SAR 1M", applies_to: "", category_id: 7, business_owner: "Finance", approvers: { "Audit Committee": "X1", "CEO": "E1", "CFO": "R1" }},
        { code: "8.1.1", description: "Approve Tax Strategy", applies_to: "TAQA", category_id: 8, business_owner: "Tax", approvers: { "Audit Committee": "X1", "CEO": "E1", "CFO": "R1", "Tax Director": "R2" }},
        { code: "9.1.1", description: "P.O/Contract > SAR 750,000", applies_to: "", category_id: 9, business_owner: "Supply Chain", approvers: { "CEO": "X", "CFO": "X2" }},
        { code: "9.5.1.1.1", description: "COO Contracts: Annual Value > SAR 3M", applies_to: "", category_id: 9, business_owner: "Supply Chain", approvers: { "CEO": "X", "COO": "X3*", "CFO": "X2", "General Counsel": "E1*" }, interpretation: "E1*: Required if the contract/agreement is not on TAQA legal approved templates"},
        { code: "10.1.1", description: "Approve QHSE Policy", applies_to: "TAQA", category_id: 10, business_owner: "QHSE", approvers: { "BOD": "X1", "CEO": "E1", "QHSE": "R1" }},
        { code: "11.1.1", description: "Initiate/Settle Litigation > SAR 5M", applies_to: "", category_id: 11, business_owner: "Legal", approvers: { "BOD": "X1", "CEO": "E1", "General Counsel": "R1" }},
        { code: "12.1.1", description: "Approve IT Strategy", applies_to: "TAQA", category_id: 12, business_owner: "Technology", approvers: { "BOD": "X1", "CEO": "E1", "CTO": "R1" }},
        { code: "13.1.1", description: "Approve Enterprise Risk Management Framework", applies_to: "TAQA", category_id: 13, business_owner: "Risk", approvers: { "Risk & Sustainability": "X1", "CEO": "E1", "VP GRC": "R1" }},
        { code: "14.1.1", description: "Approve Internal Audit Charter", applies_to: "TAQA", category_id: 14, business_owner: "Internal Audit", approvers: { "Audit Committee": "X1", "CEO": "E1", "Internal Audit": "R1" }},
      ],
      
      // High Risk Market Threshold (4.1.1)
      highRiskThreshold: {
        id: 'high-risk',
        name: 'High-Risk Market',
        code: '4.1.1',
        condition: 'Any value in High-Risk Market',
        approvers: [
          { role: 'BOD', action: 'X1', label: 'Approve' },
          { role: 'CEO', action: 'E4*', label: 'Endorse' },
          { role: 'COO', action: 'E1*', label: 'Endorse' },
          { role: 'EPF', action: 'E1*', label: 'Endorse' },
          { role: 'CFO', action: 'E3*', label: 'Endorse' },
          { role: 'General Counsel', action: 'E2*', label: 'Endorse' },
          { role: 'Marketing & Commercial', action: 'E1', label: 'Endorse' }
        ],
        notes: 'REGARDLESS OF CONTRACT VALUE - All commitments in High-Risk Markets require BOD approval. High Risk Market determined by GRC Risk Function. Review committee: CEO, CFO, COO, Commercial & Marketing, General Counsel. E1*: Either role as applicable to tender scope.'
      },

      // Non-binding RFQ/RFP/Quote Thresholds (4.2.1)
      // These are NOT affected by country/market risk designation
      nonBindingThresholds: [
        {
          id: 'nb-over-50m',
          name: 'Non-binding RFQ/RFP/Quote > SAR 50M',
          code: '4.2.1.1',
          minValue: 50000001,
          approvers: [
            { role: 'COO', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'For client budgetary purposes - applies to non-contracted work (new potential contracts). Country/market designation does not affect approval requirements for budgetary proposals.'
        },
        {
          id: 'nb-18m-50m',
          name: 'SAR 18.75M < Non-binding RFQ/RFP/Quote ≤ SAR 50M',
          code: '4.2.1.2',
          minValue: 18750001,
          maxValue: 50000000,
          approvers: [
            { role: 'Head of PSL', action: 'X1', label: 'Approve' },
            { role: 'FP&A Director', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'For client budgetary purposes - applies to non-contracted work (new potential contracts). Country/market designation does not affect approval requirements for budgetary proposals.'
        },
        {
          id: 'nb-under-18m',
          name: 'Non-binding RFQ/RFP/Quote ≤ SAR 18.75M',
          code: '4.2.1.3',
          minValue: 0,
          maxValue: 18750000,
          approvers: [
            { role: 'PSL/EPF Director', action: 'X1', label: 'Approve' },
            { role: 'PSL/CoE/EPF Finance Controller', action: 'X2', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'For client budgetary purposes - applies to non-contracted work (new potential contracts). Country/market designation does not affect approval requirements for budgetary proposals.'
        }
      ],

      // Standard Commercial Thresholds (4.2.2)
      commercialThresholds: [
        {
          id: 'over-200m',
          name: 'Contract > SAR 200 Million',
          code: '4.2.2.1',
          minValue: 200000000,
          approvers: [
            { role: 'BOD', action: 'X1', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'E1', label: 'Endorse' },
            { role: 'General Counsel', action: 'R2', label: 'Review' },
            { role: 'CFO', action: 'E3', label: 'Endorse' },
            { role: 'CEO', action: 'E4', label: 'Endorse' },
            { role: 'COO', action: 'E1*', label: 'Endorse' },
            { role: 'EPF', action: 'E1*', label: 'Endorse' }
          ],
          notes: 'Regardless of Capex value - BOD approval required for all contracts exceeding SAR 200 Million. E1*: Either COO or EPF as applicable to tender scope.'
        },
        {
          id: '50m-200m',
          name: 'SAR 50M < TCV ≤ 200M',
          code: '4.2.2.2',
          minValue: 50000000,
          maxValue: 200000000,
          approvers: [
            { role: 'ExCom', action: 'X1', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'E1', label: 'Endorse' },
            { role: 'General Counsel', action: 'R2', label: 'Review' },
            { role: 'CFO', action: 'E3', label: 'Endorse' },
            { role: 'CEO', action: 'E4', label: 'Endorse' },
            { role: 'COO', action: 'E1*', label: 'Endorse' },
            { role: 'EPF', action: 'E1*', label: 'Endorse' }
          ],
          notes: 'Regardless of Capex value. E1*: Either COO or EPF as applicable to tender scope.'
        },
        {
          id: 'capex-over-10m',
          name: 'Any Contract with Capex > SAR 10M',
          code: '4.2.2.3',
          minCapex: 10000001,
          approvers: [
            { role: 'ExCom', action: 'X1', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'E1', label: 'Endorse' },
            { role: 'CFO', action: 'E2', label: 'Endorse' },
            { role: 'CEO', action: 'E3', label: 'Endorse' },
            { role: 'COO', action: 'E1*', label: 'Endorse' },
            { role: 'EPF', action: 'E1*', label: 'Endorse' }
          ],
          notes: 'Applies to contracts ≤ SAR 200M with Capex exceeding SAR 10 Million. E1*: Either COO or EPF as applicable to tender scope.'
        },
        {
          id: '30m-50m',
          name: 'SAR 30M < TCV ≤ 50M (or Capex 5-10M)',
          code: '4.2.3.1.1',
          minValue: 30000000,
          maxValue: 50000000,
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X4', label: 'Approve' }
          ],
          notes: 'SAR 30M < TCV ≤ SAR 50M regardless of Capex; or for all contracts with SAR 5M < Capex ≤ SAR 10M'
        },
        {
          id: '5m-30m',
          name: 'SAR 5M < TCV ≤ 30M',
          code: '4.2.3.1.2',
          minValue: 5000000,
          maxValue: 30000000,
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'With Capex up to SAR 5 Million; or TCV < SAR 5M with Capex up to SAR 5M'
        },
        {
          id: 'under-5m',
          name: 'TCV ≤ SAR 5 Million',
          code: '4.2.3.1.3',
          minValue: 0,
          maxValue: 5000000,
          approvers: [
            { role: 'Head of PSL', action: 'X1', label: 'Approve' },
            { role: 'FP&A Director', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'With/without Capex up to 10% TCV (fully loaded Operating Profit with net income > 10%)'
        }
      ],

      directSalesThresholds: [
        {
          id: 'ds-low-margin',
          name: 'Low Margin (GM <40%)',
          code: '4.2.3.2.1',
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'All contracts with Gross Margin <40% regardless of Contract Value'
        },
        {
          id: 'ds-30m-50m',
          name: 'SAR 30M < TCV ≤ 50M (GM ≥40%)',
          code: '4.2.3.2.2',
          minValue: 30000000,
          maxValue: 50000000,
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'Direct Sales with Gross Margin ≥40%'
        },
        {
          id: 'ds-18m-30m',
          name: 'SAR 18.75M < TCV ≤ 30M (GM ≥40%)',
          code: '4.2.3.2.3',
          minValue: 18750000,
          maxValue: 30000000,
          approvers: [
            { role: 'Head of PSL', action: 'X1', label: 'Approve' },
            { role: 'FP&A Director', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'Direct Sales with Gross Margin ≥40%'
        },
        {
          id: 'ds-1m-18m',
          name: 'SAR 1.875M < TCV ≤ 18.75M (GM ≥40%)',
          code: '4.2.3.2.4',
          minValue: 1875000,
          maxValue: 18750000,
          approvers: [
            { role: 'Head of PSL', action: 'X2', label: 'Approve' },
            { role: 'PSL/CoE/EPF Finance Controller', action: 'X1', label: 'Approve' }
          ],
          notes: 'Direct Sales with Gross Margin ≥40%'
        },
        {
          id: 'ds-under-1m',
          name: 'TCV ≤ SAR 1.875M (GM ≥40%)',
          code: '4.2.3.2.5',
          minValue: 0,
          maxValue: 1875000,
          approvers: [
            { role: 'PSL/CoE/EPF Finance Controller', action: 'X1', label: 'Approve' },
            { role: 'PSL/EPF Director', action: 'X2', label: 'Approve' }
          ],
          notes: 'Direct Sales with Gross Margin ≥40%'
        }
      ],

      // Direct Sales - Markup Thresholds (4.2.3.2.4) - Service Lines like Chemicals
      directSalesMarkupThresholds: [
        {
          id: 'ds-markup-low',
          name: 'Product Total Cost Markup < 25%',
          code: '4.2.3.2.4.1',
          maxMarkup: 25,
          approvers: [
            { role: 'Head of PSL', action: 'X1', label: 'Approve' },
            { role: 'FP&A Director', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'COO', action: 'X4', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'Direct Service Lines Sales (e.g., Chemicals) with Product Total Cost Markup below 25%'
        },
        {
          id: 'ds-markup-high',
          name: 'Product Total Cost Markup ≥ 25%',
          code: '4.2.3.2.4.2',
          minMarkup: 25,
          approvers: [
            { role: 'Head of PSL', action: 'X1', label: 'Approve' },
            { role: 'FP&A Director', action: 'X2', label: 'Approve' },
            { role: 'Marketing & Commercial', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X', label: 'Approve' }
          ],
          notes: 'Direct Service Lines Sales (e.g., Chemicals) with Product Total Cost Markup 25% or higher'
        }
      ],

      epfThresholds: [
        {
          id: 'epf-50m',
          name: 'EPF: TCV up to SAR 50M (Capex up to 10M)',
          code: '4.2.3.3.1',
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'EPF', action: 'X2', label: 'Approve' },
            { role: 'CFO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X4', label: 'Approve' }
          ],
          notes: 'EPF Customer Commitments with TCV up to SAR 50M and Capex up to SAR 10M'
        }
      ],

      glossary: {
        'I': 'Initiate - Start the process',
        'R': 'Review/Recommend - Conduct in-depth review',
        'E': 'Endorse - Provide formal support',
        'X': 'Approve - Authority to approve',
        'N': 'Notification - Receive notification only'
      }
    };

    const formatCurrency = (value) => {
      if (value >= 1000000) return `SAR ${(value / 1000000).toFixed(1)}M`;
      return `SAR ${value.toLocaleString()}`;
    };

    // Action Badge Component
    const ActionBadge = ({ action, label, settings, theme }) => {
      const { countXWithoutNumber } = settings || { countXWithoutNumber: true };
      const isApproval = action.startsWith('X');
      const hasNumber = /\d/.test(action);
      const isExcluded = isApproval && !hasNumber && !countXWithoutNumber;
      
      let bgColor, textColor, borderColor;
      
      if (isExcluded) {
        bgColor = 'rgba(107,114,128,0.2)';
        textColor = '#9CA3AF';
        borderColor = 'rgba(107,114,128,0.3)';
      } else if (isApproval) {
        bgColor = theme.successBg;
        textColor = theme.successText;
        borderColor = 'rgba(16,185,129,0.3)';
      } else if (action.startsWith('E')) {
        bgColor = theme.warningBg;
        textColor = theme.warningText;
        borderColor = 'rgba(245,158,11,0.3)';
      } else if (action.startsWith('R')) {
        bgColor = theme.infoBg;
        textColor = theme.infoText;
        borderColor = 'rgba(14,165,233,0.3)';
      } else {
        bgColor = 'rgba(107,114,128,0.2)';
        textColor = '#9CA3AF';
        borderColor = 'rgba(107,114,128,0.3)';
      }

      return (
        <span style={{
          padding: '4px 10px',
          borderRadius: '9999px',
          fontSize: '12px',
          fontWeight: '600',
          backgroundColor: bgColor,
          color: textColor,
          border: `1px solid ${borderColor}`,
          textDecoration: isExcluded ? 'line-through' : 'none',
          whiteSpace: 'nowrap'
        }}>
          {action} {label && `- ${label}`}
        </span>
      );
    };

    // Theme Toggle
    const ThemeToggle = ({ isDark, onToggle, theme }) => (
      <button
        onClick={onToggle}
        style={{
          padding: '12px',
          borderRadius: '12px',
          backgroundColor: theme.tagBg,
          color: isDark ? '#FCD34D' : '#4B5563',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          transition: 'all 0.2s'
        }}
        title={isDark ? 'Switch to Light Mode' : 'Switch to Dark Mode'}
      >
        {isDark ? (
          <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
        ) : (
          <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
        )}
      </button>
    );

    // Storage Keys and Functions (must be before SettingsPanel)
    const STORAGE_KEYS = {
      theme: 'doa-reader-theme',
      settings: 'doa-reader-settings',
      formState: 'doa-reader-form'
    };

    // Load from localStorage
    const loadFromStorage = (key, defaultValue) => {
      try {
        const stored = localStorage.getItem(key);
        if (stored) return JSON.parse(stored);
      } catch (e) {
        console.warn('Failed to load from localStorage:', e);
      }
      return defaultValue;
    };

    // Save to localStorage
    const saveToStorage = (key, value) => {
      try {
        localStorage.setItem(key, JSON.stringify(value));
      } catch (e) {
        console.warn('Failed to save to localStorage:', e);
      }
    };

    // Default form state
    const DEFAULT_FORM_STATE = {
      contractValue: '',
      capexValue: '',
      contractType: 'standard',
      selectedCountry: '',
      manualHighRisk: false,
      grossMargin: '',
      operatingProfitSAR: '',
      operatingProfitPercent: '45',  // Default 45%
      markupPercent: ''  // For Direct Sales - Markup
    };

    // Settings Panel
    const SettingsPanel = ({ settings, setSettings, isOpen, onClose, theme, formState }) => {
      const [countrySearch, setCountrySearch] = useState('');
      const [specialCountrySearch, setSpecialCountrySearch] = useState('');
      const fileInputRef = React.useRef(null);

      if (!isOpen) return null;

      const addCountry = (country) => {
        if (country && !settings.safeCountries.includes(country)) {
          setSettings(prev => ({ ...prev, safeCountries: [...prev.safeCountries, country].sort() }));
        }
        setCountrySearch('');
      };

      const removeCountry = (country) => {
        setSettings(prev => ({ ...prev, safeCountries: prev.safeCountries.filter(c => c !== country) }));
      };

      const addSpecialCountry = (country) => {
        if (country && !settings.specialCountries?.includes(country)) {
          setSettings(prev => ({ ...prev, specialCountries: [...(prev.specialCountries || []), country].sort() }));
        }
        setSpecialCountrySearch('');
      };

      const removeSpecialCountry = (country) => {
        setSettings(prev => ({ ...prev, specialCountries: (prev.specialCountries || []).filter(c => c !== country) }));
      };

      const filteredCountries = ALL_COUNTRIES.filter(c => 
        !settings.safeCountries.includes(c) && c.toLowerCase().includes(countrySearch.toLowerCase())
      );

      const filteredSpecialCountries = ALL_COUNTRIES.filter(c => 
        !(settings.specialCountries || []).includes(c) && c.toLowerCase().includes(specialCountrySearch.toLowerCase())
      );

      // Export settings to JSON file
      const exportSettings = () => {
        const exportData = {
          version: '1.0',
          exportDate: new Date().toISOString(),
          settings: settings,
          formState: formState
        };
        
        const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `doa-reader-settings-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      };

      // Import settings from JSON file
      const importSettings = (event) => {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const importData = JSON.parse(e.target.result);
            
            if (importData.settings) {
              setSettings(importData.settings);
              saveToStorage(STORAGE_KEYS.settings, importData.settings);
            }
            
            alert('Settings imported successfully!');
          } catch (error) {
            alert('Error importing settings: Invalid JSON file');
            console.error('Import error:', error);
          }
        };
        reader.readAsText(file);
        
        // Reset file input
        event.target.value = '';
      };

      return (
        <div style={{ position: 'fixed', inset: 0, backgroundColor: 'rgba(0,0,0,0.6)', backdropFilter: 'blur(4px)', zIndex: 50, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '16px' }}>
          <div style={{ backgroundColor: theme.modalBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '24px', padding: '32px', maxWidth: '640px', width: '100%', maxHeight: '90vh', overflowY: 'auto', color: theme.text }} className="animate-fadeIn">
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>
              <h2 style={{ fontSize: '24px', fontWeight: 'bold', display: 'flex', alignItems: 'center', gap: '12px' }}>
                <span style={{ width: '40px', height: '40px', borderRadius: '12px', background: `linear-gradient(135deg, ${COLORS.accent}, ${COLORS.accentLight})`, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="white">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </span>
                Settings
              </h2>
              <button onClick={onClose} style={{ background: 'none', color: theme.textMuted, fontSize: '28px', lineHeight: 1 }}>ם</button>
            </div>

            {/* X Without Number Toggle */}
            <div style={{ backgroundColor: theme.inputBg, borderRadius: '16px', padding: '20px', border: `1px solid ${theme.cardBorder}`, marginBottom: '24px' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '16px' }}>
                <div>
                  <h3 style={{ fontWeight: '600', marginBottom: '4px' }}>Count "X" Without Number</h3>
                  <p style={{ color: theme.textMuted, fontSize: '14px' }}>When enabled, "X" (without a number) is treated as an approval authority.</p>
                </div>
                <button
                  onClick={() => setSettings(prev => ({ ...prev, countXWithoutNumber: !prev.countXWithoutNumber }))}
                  style={{ width: '56px', height: '32px', borderRadius: '16px', backgroundColor: settings.countXWithoutNumber ? COLORS.primary : '#6B7280', position: 'relative', transition: 'background-color 0.2s', flexShrink: 0 }}
                >
                  <div style={{ width: '24px', height: '24px', borderRadius: '50%', backgroundColor: 'white', position: 'absolute', top: '4px', transition: 'left 0.2s', left: settings.countXWithoutNumber ? '28px' : '4px', boxShadow: '0 2px 4px rgba(0,0,0,0.2)' }} />
                </button>
              </div>
            </div>

            {/* Safe Countries */}
            <div style={{ backgroundColor: theme.inputBg, borderRadius: '16px', padding: '20px', border: `1px solid ${theme.cardBorder}` }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                <div>
                  <h3 style={{ fontWeight: '600', display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={COLORS.primary}>
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Safe Countries / Markets
                  </h3>
                  <p style={{ color: theme.textMuted, fontSize: '14px', marginTop: '4px' }}>Countries NOT in this list are <span style={{ color: COLORS.danger, fontWeight: '500' }}>High-Risk</span></p>
                </div>
                <span style={{ padding: '4px 12px', borderRadius: '9999px', fontSize: '14px', fontWeight: '500', backgroundColor: `${COLORS.primary}20`, color: COLORS.primary }}>{settings.safeCountries.length}</span>
              </div>

              <div style={{ position: 'relative', marginBottom: '16px' }}>
                <input
                  type="text"
                  value={countrySearch}
                  onChange={(e) => setCountrySearch(e.target.value)}
                  placeholder="Search to add country..."
                  style={{ width: '100%', padding: '12px 16px', borderRadius: '12px', border: `1px solid ${theme.cardBorder}`, backgroundColor: theme.cardBg, color: theme.text, fontSize: '14px' }}
                />
                {countrySearch && filteredCountries.length > 0 && (
                  <div style={{ position: 'absolute', top: '100%', left: 0, right: 0, marginTop: '8px', backgroundColor: theme.cardBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '12px', maxHeight: '200px', overflowY: 'auto', zIndex: 10 }}>
                    {filteredCountries.slice(0, 10).map(country => (
                      <button
                        key={country}
                        onClick={() => addCountry(country)}
                        style={{ width: '100%', padding: '10px 16px', textAlign: 'left', background: 'none', color: theme.textMuted, fontSize: '14px' }}
                        onMouseOver={(e) => e.target.style.backgroundColor = theme.tagBg}
                        onMouseOut={(e) => e.target.style.backgroundColor = 'transparent'}
                      >
                        {country}
                      </button>
                    ))}
                  </div>
                )}
              </div>

              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px', maxHeight: '150px', overflowY: 'auto' }}>
                {settings.safeCountries.map(country => (
                  <span key={country} style={{ display: 'inline-flex', alignItems: 'center', gap: '6px', padding: '6px 12px', borderRadius: '8px', fontSize: '14px', backgroundColor: `${COLORS.primary}15`, color: COLORS.primary, border: `1px solid ${COLORS.primary}30` }}>
                    {country}
                    <button onClick={() => removeCountry(country)} style={{ background: 'none', color: 'inherit', opacity: 0.6, fontSize: '16px', lineHeight: 1 }}>ם</button>
                  </span>
                ))}
              </div>

              <div style={{ display: 'flex', gap: '8px', marginTop: '16px', paddingTop: '16px', borderTop: `1px solid ${theme.cardBorder}` }}>
                <button onClick={() => setSettings(prev => ({ ...prev, safeCountries: DEFAULT_SAFE_COUNTRIES.sort() }))} style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: theme.tagBg, color: theme.textMuted, borderRadius: '8px' }}>Reset to Default</button>
                <button onClick={() => setSettings(prev => ({ ...prev, safeCountries: [] }))} style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: 'rgba(239,68,68,0.1)', color: COLORS.danger, borderRadius: '8px' }}>Clear All</button>
              </div>
            </div>

            {/* Special Countries - CEO Approval Required */}
            <div style={{ backgroundColor: theme.inputBg, borderRadius: '16px', padding: '20px', border: `1px solid ${theme.cardBorder}`, marginTop: '24px' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                <div>
                  <h3 style={{ fontWeight: '600', display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={COLORS.warning}>
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                    Special Countries
                  </h3>
                  <p style={{ color: theme.textMuted, fontSize: '14px', marginTop: '4px' }}>Countries requiring <span style={{ color: COLORS.warning, fontWeight: '500' }}>CEO approval</span> regardless of value (unless ExCom/BoD required)</p>
                </div>
                <span style={{ padding: '4px 12px', borderRadius: '9999px', fontSize: '14px', fontWeight: '500', backgroundColor: `${COLORS.warning}20`, color: COLORS.warning }}>{(settings.specialCountries || []).length}</span>
              </div>

              <div style={{ position: 'relative', marginBottom: '16px' }}>
                <input
                  type="text"
                  value={specialCountrySearch}
                  onChange={(e) => setSpecialCountrySearch(e.target.value)}
                  placeholder="Search to add special country..."
                  style={{ width: '100%', padding: '12px 16px', borderRadius: '12px', border: `1px solid ${theme.cardBorder}`, backgroundColor: theme.cardBg, color: theme.text, fontSize: '14px' }}
                />
                {specialCountrySearch && filteredSpecialCountries.length > 0 && (
                  <div style={{ position: 'absolute', top: '100%', left: 0, right: 0, marginTop: '8px', backgroundColor: theme.cardBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '12px', maxHeight: '200px', overflowY: 'auto', zIndex: 10 }}>
                    {filteredSpecialCountries.slice(0, 10).map(country => (
                      <button
                        key={country}
                        onClick={() => addSpecialCountry(country)}
                        style={{ width: '100%', padding: '10px 16px', textAlign: 'left', background: 'none', color: theme.textMuted, fontSize: '14px' }}
                        onMouseOver={(e) => e.target.style.backgroundColor = theme.tagBg}
                        onMouseOut={(e) => e.target.style.backgroundColor = 'transparent'}
                      >
                        {country}
                      </button>
                    ))}
                  </div>
                )}
              </div>

              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px', maxHeight: '150px', overflowY: 'auto' }}>
                {(settings.specialCountries || []).map(country => (
                  <span key={country} style={{ display: 'inline-flex', alignItems: 'center', gap: '6px', padding: '6px 12px', borderRadius: '8px', fontSize: '14px', backgroundColor: `${COLORS.warning}15`, color: COLORS.warning, border: `1px solid ${COLORS.warning}30` }}>
                    {country}
                    <button onClick={() => removeSpecialCountry(country)} style={{ background: 'none', color: 'inherit', opacity: 0.6, fontSize: '16px', lineHeight: 1 }}>ם</button>
                  </span>
                ))}
              </div>

              <div style={{ display: 'flex', gap: '8px', marginTop: '16px', paddingTop: '16px', borderTop: `1px solid ${theme.cardBorder}` }}>
                <button onClick={() => setSettings(prev => ({ ...prev, specialCountries: DEFAULT_SPECIAL_COUNTRIES.sort() }))} style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: theme.tagBg, color: theme.textMuted, borderRadius: '8px' }}>Reset to Default</button>
                <button onClick={() => setSettings(prev => ({ ...prev, specialCountries: [] }))} style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: 'rgba(239,68,68,0.1)', color: COLORS.danger, borderRadius: '8px' }}>Clear All</button>
              </div>
            </div>

            {/* Export/Import Settings */}
            <div style={{ backgroundColor: theme.inputBg, borderRadius: '16px', padding: '20px', border: `1px solid ${theme.cardBorder}`, marginTop: '24px' }}>
              <h3 style={{ fontWeight: '600', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={COLORS.primary}>
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                </svg>
                Backup & Restore
              </h3>
              <p style={{ color: theme.textMuted, fontSize: '14px', marginBottom: '16px' }}>
                Export your settings to a JSON file for backup or sharing. Import to restore settings.
              </p>
              <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
                <button
                  onClick={exportSettings}
                  style={{ 
                    padding: '10px 16px', 
                    fontSize: '14px', 
                    fontWeight: '500',
                    backgroundColor: `${COLORS.primary}20`, 
                    color: COLORS.primary, 
                    borderRadius: '10px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px',
                    border: `1px solid ${COLORS.primary}40`
                  }}
                >
                  <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                  </svg>
                  Export Settings (JSON)
                </button>
                <button
                  onClick={() => fileInputRef.current?.click()}
                  style={{ 
                    padding: '10px 16px', 
                    fontSize: '14px', 
                    fontWeight: '500',
                    backgroundColor: theme.tagBg, 
                    color: theme.textMuted, 
                    borderRadius: '10px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}
                >
                  <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                  </svg>
                  Import Settings
                </button>
                <input
                  ref={fileInputRef}
                  type="file"
                  accept=".json"
                  onChange={importSettings}
                  style={{ display: 'none' }}
                />
              </div>
            </div>

            <div style={{ marginTop: '32px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px', color: theme.textSubtle, fontSize: '12px' }}>
                <svg width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                </svg>
                Settings saved automatically
              </div>
              <button onClick={onClose} style={{ padding: '12px 24px', fontWeight: '600', borderRadius: '12px', background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})`, color: 'white' }}>Done</button>
            </div>
          </div>
        </div>
      );
    };

    // Main Calculator Component
    const OpportunityCalculator = ({ settings, theme, formState, setFormState }) => {
      // Destructure form state
      const {
        contractValue, capexValue, contractType, selectedCountry,
        manualHighRisk, grossMargin,
        operatingProfitSAR, operatingProfitPercent, markupPercent
      } = formState;

      // Update form field helper
      const updateField = (field, value) => {
        setFormState(prev => ({ ...prev, [field]: value }));
      };

      // Handle Operating Profit SAR change - calculate percentage
      const handleOperatingProfitSARChange = (value) => {
        updateField('operatingProfitSAR', value);
        const cv = parseFloat(contractValue) || 0;
        const opSAR = parseFloat(value) || 0;
        if (cv > 0 && opSAR >= 0) {
          const percent = (opSAR / cv) * 100;
          updateField('operatingProfitPercent', percent.toFixed(2));
        }
      };

      // Handle Operating Profit % change - calculate SAR
      const handleOperatingProfitPercentChange = (value) => {
        updateField('operatingProfitPercent', value);
        const cv = parseFloat(contractValue) || 0;
        const percent = parseFloat(value) || 0;
        if (cv > 0 && percent >= 0) {
          const sarValue = (percent / 100) * cv;
          updateField('operatingProfitSAR', Math.round(sarValue).toString());
        }
      };

      // Recalculate Operating Profit SAR when TCV changes (if % is set)
      useEffect(() => {
        const cv = parseFloat(contractValue) || 0;
        const percent = parseFloat(operatingProfitPercent) || 0;
        if (cv > 0 && percent > 0) {
          const sarValue = (percent / 100) * cv;
          updateField('operatingProfitSAR', Math.round(sarValue).toString());
        } else if (cv === 0) {
          updateField('operatingProfitSAR', '');
        }
      }, [contractValue]);

      const isHighRiskCountry = selectedCountry && !settings.safeCountries.includes(selectedCountry);
      const isHighRisk = manualHighRisk || isHighRiskCountry;
      const isSpecialCountry = selectedCountry && (settings.specialCountries || []).includes(selectedCountry);
      
      // Calculate Capex as percentage of TCV
      const capexPercentage = useMemo(() => {
        const cv = parseFloat(contractValue) || 0;
        const capex = parseFloat(capexValue) || 0;
        if (cv > 0 && capex > 0) {
          return (capex / cv) * 100;
        }
        return 0;
      }, [contractValue, capexValue]);
      
      const isCapexExceeds10Percent = capexPercentage > 10;
      
      // Check if Operating Profit is below 10%
      const operatingProfitPct = parseFloat(operatingProfitPercent) || 45;
      const isLowOperatingProfit = operatingProfitPct <= 10;

      const result = useMemo(() => {
        const cv = parseFloat(contractValue) || 0;
        const capex = parseFloat(capexValue) || 0;
        const gm = parseFloat(grossMargin) || 100;

        if (cv <= 0) return null;

        // Non-binding RFQs/RFPs/Quotes - NOT affected by country/market risk
        // These are budgetary proposals only, no commitment involved
        if (contractType === 'nonBinding') {
          if (cv > 50000000) return DOA_DATA.nonBindingThresholds[0]; // > 50M
          if (cv > 18750000) return DOA_DATA.nonBindingThresholds[1]; // > 18.75M ≤ 50M
          return DOA_DATA.nonBindingThresholds[2]; // ≤ 18.75M
        }

        // High Risk Market overrides everything (for committed work only)
        if (isHighRisk) return DOA_DATA.highRiskThreshold;

        // EPF
        if (contractType === 'epf') {
          if (cv <= 50000000 && capex <= 10000000) return DOA_DATA.epfThresholds[0];
          if (capex > 10000000) return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          if (cv > 50000000 && cv <= 200000000) return DOA_DATA.commercialThresholds.find(t => t.id === '50m-200m');
          if (cv > 200000000) return DOA_DATA.commercialThresholds.find(t => t.id === 'over-200m');
        }

        // Direct Sales - Markup (Service Lines like Chemicals)
        // Escalation factors (TCV, Capex) supersede markup-based approval
        if (contractType === 'directSalesMarkup') {
          // ESCALATION CHECK 1: TCV > 200M → BOD (4.2.2.1)
          if (cv > 200000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'over-200m');
          }

          // ESCALATION CHECK 2: Capex > 10M → ExCom (4.2.2.3)
          if (capex > 10000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          }

          // ESCALATION CHECK 3: TCV > 50M → ExCom (4.2.2.2)
          if (cv > 50000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === '50m-200m');
          }

          // ESCALATION CHECK 4: Capex 5-10M → CEO X4 level (4.2.3.1.1)
          if (capex > 5000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === '30m-50m');
          }

          // Within normal bounds - apply markup-based approval (4.2.3.2.4.x)
          const markup = parseFloat(markupPercent) || 0;
          if (markup < 25) {
            return DOA_DATA.directSalesMarkupThresholds.find(t => t.id === 'ds-markup-low');
          }
          return DOA_DATA.directSalesMarkupThresholds.find(t => t.id === 'ds-markup-high');
        }

        // Direct Sales - TCV > 50M escalates to 4.2.2.* (commercial thresholds)
        // 4.2.3.2.1/2/3 rules only apply within 4.2.3 scope (TCV ≤ 50M)
        if (contractType === 'directSales') {
          // If TCV > 50M, route to commercial escalation (4.2.2.*) instead of 4.2.3.2.*
          if (cv > 50000000) {
            // Check in same order as standard contracts
            if (cv > 200000000) return DOA_DATA.commercialThresholds.find(t => t.id === 'over-200m');
            if (capex > 10000000) return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
            return DOA_DATA.commercialThresholds.find(t => t.id === '50m-200m');
          }
          // TCV ≤ 50M - apply 4.2.3.2.1/2/3/4/5 rules
          if (gm < 40) return DOA_DATA.directSalesThresholds.find(t => t.id === 'ds-low-margin');
          if (cv > 30000000) return DOA_DATA.directSalesThresholds.find(t => t.id === 'ds-30m-50m');
          if (cv > 18750000) return DOA_DATA.directSalesThresholds.find(t => t.id === 'ds-18m-30m');
          if (cv > 1875000) return DOA_DATA.directSalesThresholds.find(t => t.id === 'ds-1m-18m');
          return DOA_DATA.directSalesThresholds.find(t => t.id === 'ds-under-1m');
        }

        // Standard Contracts - TCV determines base approval, then check escalation factors
        
        // BAND 1: TCV > 200M → BOD (4.2.2.1) - regardless of any other factor
        if (cv > 200000000) {
          return DOA_DATA.commercialThresholds.find(t => t.id === 'over-200m');
        }
        
        // BAND 2: TCV 50M - 200M → ExCom (4.2.2.2)
        // Also escalates here if Capex > 10M (4.2.2.3)
        if (cv > 50000000) {
          // Both 50M-200M TCV and Capex >10M go to ExCom
          if (capex > 10000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          }
          return DOA_DATA.commercialThresholds.find(t => t.id === '50m-200m');
        }
        
        // BAND 3: TCV 30M - 50M → CEO X4 (4.2.3.1.1)
        // Check if Capex >10M escalates to ExCom
        if (cv > 30000000) {
          if (capex > 10000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          }
          return DOA_DATA.commercialThresholds.find(t => t.id === '30m-50m');
        }
        
        // BAND 4: TCV 5M - 30M → COO level (4.2.3.1.2)
        // Check if Capex >10M escalates to ExCom, or Capex 5-10M escalates to CEO
        if (cv > 5000000) {
          if (capex > 10000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          }
          if (capex > 5000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === '30m-50m');
          }
          return DOA_DATA.commercialThresholds.find(t => t.id === '5m-30m');
        }
        
        // BAND 5: TCV ≤ 5M (4.2.3.1.3)
        // Check escalation: Capex >10M → ExCom, Capex 5-10M → CEO, Capex% >10% or OP ≤10% → COO
        if (cv <= 5000000) {
          // First check absolute Capex escalations
          if (capex > 10000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === 'capex-over-10m');
          }
          if (capex > 5000000) {
            return DOA_DATA.commercialThresholds.find(t => t.id === '30m-50m');
          }
          
          // Then check percentage-based escalations
          const capexPercent = cv > 0 ? (capex / cv) * 100 : 0;
          const opProfit = parseFloat(operatingProfitPercent) || 45;

          // Escalated approval chain - 4.2.3.1.2 level (COO)
          const escalatedApprovers = [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' }
          ];

          if (capexPercent > 10 && opProfit <= 10) {
            return {
              id: '5m-30m-escalated',
              name: '≤ SAR 5M (Escalated - Multiple Factors)',
              code: '4.2.3.1.2',
              approvers: escalatedApprovers,
              notes: 'Capex exceeds 10% of TCV AND Operating Profit ≤ 10%. Per 4.2.3.1.3 requirements (fully loaded Operating Profit with net income > 10%), approval escalated to 4.2.3.1.2 level (COO).'
            };
          } else if (capexPercent > 10) {
            return {
              id: '5m-30m-escalated',
              name: '≤ SAR 5M but Capex > 10% TCV (Escalated)',
              code: '4.2.3.1.2',
              approvers: escalatedApprovers,
              notes: 'Capex exceeds 10% of TCV. Per 4.2.3.1.3 requirements, approval escalated to 4.2.3.1.2 level (COO).'
            };
          } else if (opProfit <= 10) {
            return {
              id: '5m-30m-escalated',
              name: '≤ SAR 5M but Operating Profit ≤ 10% (Escalated)',
              code: '4.2.3.1.2',
              approvers: escalatedApprovers,
              notes: 'Operating Profit is ≤ 10%. Per 4.2.3.1.3 requirements (fully loaded Operating Profit with net income > 10%), approval escalated to 4.2.3.1.2 level (COO).'
            };
          }
          return DOA_DATA.commercialThresholds.find(t => t.id === 'under-5m');
        }

        return DOA_DATA.commercialThresholds.find(t => t.id === 'under-5m');
      }, [contractValue, capexValue, contractType, isHighRisk, grossMargin, operatingProfitPercent, markupPercent]);

      // Apply Special Country escalation - escalate to CEO unless already going to ExCom/BoD
      // Does NOT apply to non-binding/budgetary proposals
      const specialCountryResult = useMemo(() => {
        if (!result || !isSpecialCountry) return result;
        
        // Non-binding proposals are not affected by country designation
        if (contractType === 'nonBinding') return result;
        
        // Check if result is already at ExCom or BoD level - don't escalate
        const highLevelApprovers = ['BOD', 'ExCom', 'General Assembly'];
        const hasHighLevelApproval = result.approvers?.some(a => 
          highLevelApprovers.includes(a.role) && a.action.startsWith('X')
        );
        
        if (hasHighLevelApproval) return result;
        
        // Check if already at CEO level with X number (not just delegable X)
        const hasCEONumberedApproval = result.approvers?.some(a => 
          a.role === 'CEO' && /^X\d+/.test(a.action)
        );
        
        if (hasCEONumberedApproval) return result;
        
        // Escalate to CEO level (similar to 4.2.3.1.1 structure)
        return {
          id: 'special-country-ceo',
          name: `${result.name} (Special Country - CEO Required)`,
          code: result.code,
          minValue: result.minValue,
          maxValue: result.maxValue,
          approvers: [
            { role: 'Marketing & Commercial', action: 'X1', label: 'Approve' },
            { role: 'CFO', action: 'X2', label: 'Approve' },
            { role: 'COO', action: 'X3', label: 'Approve' },
            { role: 'CEO', action: 'X4', label: 'Approve' }
          ],
          notes: `${result.notes || ''} SPECIAL COUNTRY: ${selectedCountry} requires CEO approval regardless of contract value per DOA special country designation.`
        };
      }, [result, isSpecialCountry, selectedCountry, contractType]);

      const filteredResult = useMemo(() => {
        const baseResult = specialCountryResult;
        if (!baseResult) return null;
        const filtered = { ...baseResult };
        // Apply approval chain ordering: I → R → E → X, by level, * does not affect sort
        const sortedApprovers = normalizeAndSortApprovers(baseResult.approvers);
        if (!settings.countXWithoutNumber) {
          filtered.approvers = sortedApprovers.filter(a => a.action !== 'X');
          filtered.excludedApprovers = sortedApprovers.filter(a => a.action === 'X');
        } else {
          filtered.approvers = sortedApprovers;
        }
        return filtered;
      }, [specialCountryResult, settings.countXWithoutNumber]);

      const inputStyle = { width: '100%', padding: '12px 16px', borderRadius: '12px', border: `1px solid ${theme.cardBorder}`, backgroundColor: theme.inputBg, color: theme.text, fontSize: '14px' };
      const labelStyle = { display: 'block', fontSize: '14px', fontWeight: '500', color: theme.textMuted, marginBottom: '8px' };

      return (
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(380px, 1fr))', gap: '32px' }}>
          {/* Input Card */}
          <div style={{ backgroundColor: theme.cardBg, backdropFilter: 'blur(8px)', border: `1px solid ${theme.cardBorder}`, borderRadius: '24px', padding: '32px' }}>
            <h3 style={{ fontSize: '24px', fontWeight: 'bold', color: theme.text, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
              <span style={{ width: '40px', height: '40px', borderRadius: '12px', background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})`, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="white">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                </svg>
              </span>
              Opportunity Details
            </h3>

            <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>
              {/* Country */}
              <div>
                <label style={labelStyle}>
                  Country / Market
                  {isHighRiskCountry && <span style={{ marginLeft: '8px', padding: '2px 8px', backgroundColor: theme.dangerBg, color: theme.dangerText, borderRadius: '4px', fontSize: '12px', fontWeight: '600' }}>HIGH RISK</span>}
                  {isSpecialCountry && <span style={{ marginLeft: '8px', padding: '2px 8px', backgroundColor: `${COLORS.warning}20`, color: COLORS.warning, borderRadius: '4px', fontSize: '12px', fontWeight: '600' }}>SPECIAL - CEO REQUIRED</span>}
                </label>
                <select value={selectedCountry} onChange={(e) => updateField('selectedCountry', e.target.value)} style={{ ...inputStyle, borderColor: isHighRiskCountry ? 'rgba(239,68,68,0.5)' : isSpecialCountry ? `${COLORS.warning}80` : theme.cardBorder }}>
                  <option value="">Select Country...</option>
                  {(settings.specialCountries || []).length > 0 && (
                    <optgroup label="⚠️ Special Countries (CEO Required)">
                      {(settings.specialCountries || []).map(c => <option key={c} value={c}>{c}</option>)}
                    </optgroup>
                  )}
                  <optgroup label="Safe Markets">
                    {settings.safeCountries.filter(c => !(settings.specialCountries || []).includes(c)).map(c => <option key={c} value={c}>{c}</option>)}
                  </optgroup>
                  <optgroup label="Other Markets (High Risk)">
                    {ALL_COUNTRIES.filter(c => !settings.safeCountries.includes(c) && !(settings.specialCountries || []).includes(c)).map(c => <option key={c} value={c}>{c}</option>)}
                  </optgroup>
                </select>
              </div>

              {/* Contract Type - Updated with Non-binding option */}
              <div>
                <label style={labelStyle}>Contract Type</label>
                <select data-testid="contract-type-select" value={contractType} onChange={(e) => updateField('contractType', e.target.value)} style={inputStyle}>
                  <option value="standard">Standard (Bids, Tenders, Contracts)</option>
                  <option value="nonBinding">Non-binding RFQ/RFP/Quote (Budgetary)</option>
                  <option value="directSales">Direct Sales</option>
                  <option value="directSalesMarkup">Direct Sales - Markup (Chemicals, etc.)</option>
                  <option value="epf">EPF Commitments</option>
                </select>
              </div>

              {/* Info for Non-binding */}
              {contractType === 'nonBinding' && (
                <div style={{ padding: '12px 16px', backgroundColor: theme.infoBg, border: `1px solid ${COLORS.info}30`, borderRadius: '12px' }}>
                  <p style={{ color: theme.infoText, fontSize: '14px', margin: 0 }}>
                    <strong>4.2.1:</strong> For client budgetary purposes - applies to non-contracted work (new potential contracts).
                  </p>
                  <p style={{ color: theme.infoText, fontSize: '13px', marginTop: '8px', marginBottom: 0, opacity: 0.9 }}>
                    <em>Note: Country/market selection does not affect approval requirements for budgetary proposals.</em>
                  </p>
                </div>
              )}

              {/* Contract Value */}
              <div>
                <label style={labelStyle}>Total Contract Value (SAR)</label>
                <input data-testid="contract-value-input" type="number" value={contractValue} onChange={(e) => updateField('contractValue', e.target.value)} placeholder="e.g., 25000000" style={inputStyle} />
                {contractValue && <p style={{ marginTop: '6px', fontSize: '14px', fontWeight: '500', color: COLORS.primary }}>{formatCurrency(parseFloat(contractValue))}</p>}
              </div>

              {/* Capex - Hidden for Non-binding */}
              {contractType !== 'nonBinding' && (
                <div>
                  <label style={labelStyle}>
                    Capex Value (SAR)
                    {contractValue && capexValue && (
                      <span style={{ 
                        marginLeft: '8px', 
                        padding: '2px 8px', 
                        backgroundColor: isCapexExceeds10Percent ? theme.warningBg : theme.successBg, 
                        color: isCapexExceeds10Percent ? theme.warningText : theme.successText, 
                        borderRadius: '4px', 
                        fontSize: '12px', 
                        fontWeight: '600' 
                      }}>
                        {capexPercentage.toFixed(1)}% of TCV
                      </span>
                    )}
                  </label>
                  <input data-testid="capex-value-input" type="number" value={capexValue} onChange={(e) => updateField('capexValue', e.target.value)} placeholder="e.g., 5000000" style={inputStyle} />
                  {capexValue && (
                    <p style={{ marginTop: '6px', fontSize: '14px', fontWeight: '500', color: COLORS.primary }}>
                      {formatCurrency(parseFloat(capexValue))}
                    </p>
                  )}
                  {isCapexExceeds10Percent && parseFloat(contractValue) <= 5000000 && contractType === 'standard' && (
                    <div style={{ marginTop: '8px', padding: '10px 12px', backgroundColor: theme.warningBg, border: `1px solid ${COLORS.warning}30`, borderRadius: '8px', display: 'flex', alignItems: 'flex-start', gap: '8px' }}>
                      <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke={theme.warningText} style={{ flexShrink: 0, marginTop: '2px' }}>
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                      </svg>
                      <p style={{ color: theme.warningText, fontSize: '13px' }}>
                        <strong>Capex exceeds 10% of TCV.</strong> Per 4.2.3.1.3, approval will be escalated to 4.2.3.1.2 level.
                      </p>
                    </div>
                  )}
                </div>
              )}

              {/* Expected Operating Profit - SAR and % with bidirectional calculation */}
              {/* EPF only uses TCV and Capex - no Profit/Margin fields needed */}
              {contractType !== 'nonBinding' && contractType !== 'epf' && (
                <div>
                  <label style={labelStyle}>
                    Expected Operating Profit
                    {operatingProfitPercent && (
                      <span style={{ 
                        marginLeft: '8px', 
                        padding: '2px 8px', 
                        backgroundColor: parseFloat(operatingProfitPercent) > 10 ? theme.successBg : theme.dangerBg, 
                        color: parseFloat(operatingProfitPercent) > 10 ? theme.successText : theme.dangerText, 
                        borderRadius: '4px', 
                        fontSize: '12px', 
                        fontWeight: '600' 
                      }}>
                        {parseFloat(operatingProfitPercent) > 10 ? '✓ Above 10%' : '⚠ Below 10%'}
                      </span>
                    )}
                  </label>
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr auto 1fr', gap: '12px', alignItems: 'center' }}>
                    <div>
                      <input 
                        type="number" 
                        value={operatingProfitSAR} 
                        onChange={(e) => handleOperatingProfitSARChange(e.target.value)} 
                        placeholder="SAR value" 
                        style={inputStyle} 
                      />
                      {operatingProfitSAR && (
                        <p style={{ marginTop: '4px', fontSize: '12px', color: theme.textMuted }}>
                          {formatCurrency(parseFloat(operatingProfitSAR))}
                        </p>
                      )}
                    </div>
                    <div style={{ color: theme.textMuted, fontWeight: '600', fontSize: '14px' }}>OR</div>
                    <div style={{ position: 'relative' }}>
                      <input 
                        type="number" 
                        value={operatingProfitPercent} 
                        onChange={(e) => handleOperatingProfitPercentChange(e.target.value)} 
                        placeholder="%" 
                        style={{ ...inputStyle, paddingRight: '36px' }} 
                      />
                      <span style={{ position: 'absolute', right: '14px', top: '50%', transform: 'translateY(-50%)', color: theme.textMuted, fontWeight: '500' }}>%</span>
                    </div>
                  </div>
                  <p style={{ marginTop: '6px', fontSize: '12px', color: theme.textSubtle }}>
                    Edit either field - the other calculates automatically based on TCV
                  </p>
                </div>
              )}

              {/* Direct Sales Fields */}
              {contractType === 'directSales' && (
                <div data-testid="direct-sales-mode">
                  <div>
                    <label style={labelStyle}>Gross Margin (%)</label>
                    <input data-testid="gross-margin-input" type="number" value={grossMargin} onChange={(e) => updateField('grossMargin', e.target.value)} placeholder="e.g., 45" style={inputStyle} />
                  </div>
                </div>
              )}

              {/* Direct Sales - Markup Fields */}
              {contractType === 'directSalesMarkup' && (
                <div>
                  <label style={labelStyle}>
                    Product Total Cost Markup (%)
                    {markupPercent && (
                      <span style={{
                        marginLeft: '8px',
                        padding: '2px 8px',
                        backgroundColor: parseFloat(markupPercent) >= 25 ? theme.successBg : theme.warningBg,
                        color: parseFloat(markupPercent) >= 25 ? theme.successText : theme.warningText,
                        borderRadius: '4px',
                        fontSize: '12px',
                        fontWeight: '600'
                      }}>
                        {parseFloat(markupPercent) >= 25 ? '≥ 25% (Higher Delegation)' : '< 25% (Lower Delegation)'}
                      </span>
                    )}
                  </label>
                  <input
                    data-testid="markup-percent-input"
                    type="number"
                    value={markupPercent}
                    onChange={(e) => updateField('markupPercent', e.target.value)}
                    placeholder="e.g., 30"
                    style={inputStyle}
                  />
                  <div style={{ marginTop: '12px', padding: '12px', backgroundColor: theme.infoBg, border: `1px solid ${COLORS.info}30`, borderRadius: '8px' }}>
                    <p style={{ fontSize: '13px', color: theme.infoText, margin: 0 }}>
                      <strong>4.2.3.2.4:</strong> Direct Service Lines Sales (e.g., Chemicals). Markup ≥ 25% has higher delegation level.
                    </p>
                    <p style={{ fontSize: '12px', color: theme.infoText, marginTop: '8px', marginBottom: 0, opacity: 0.9 }}>
                      <em>Note: TCV &gt; 50M or Capex &gt; 10M will escalate to higher approval levels regardless of markup.</em>
                    </p>
                  </div>
                </div>
              )}

              {/* Manual High Risk */}
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', padding: '16px', borderRadius: '12px', backgroundColor: isHighRisk ? theme.dangerBg : 'rgba(239,68,68,0.05)', border: `1px solid ${isHighRisk ? 'rgba(239,68,68,0.3)' : 'rgba(239,68,68,0.15)'}` }}>
                <input type="checkbox" checked={manualHighRisk} onChange={(e) => updateField('manualHighRisk', e.target.checked)} disabled={isHighRiskCountry} style={{ width: '20px', height: '20px', accentColor: COLORS.danger }} />
                <label style={{ color: theme.textMuted, fontSize: '14px' }}>
                  <span style={{ fontWeight: '600', color: COLORS.danger }}>Manual High-Risk Override</span>
                  <span style={{ marginLeft: '8px', color: theme.textSubtle }}>(if determined by GRC)</span>
                </label>
              </div>

              {/* Clear Form Button */}
              <button 
                onClick={() => setFormState(DEFAULT_FORM_STATE)}
                style={{ 
                  padding: '10px 16px', 
                  fontSize: '14px', 
                  backgroundColor: theme.tagBg, 
                  color: theme.textMuted, 
                  borderRadius: '10px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '8px',
                  transition: 'all 0.2s'
                }}
              >
                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                Reset Form
              </button>
            </div>
          </div>

          {/* Result Card */}
          <div style={{ backgroundColor: theme.cardBg, backdropFilter: 'blur(8px)', border: `1px solid ${theme.cardBorder}`, borderRadius: '24px', padding: '32px' }}>
            <h3 style={{ fontSize: '24px', fontWeight: 'bold', color: theme.text, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
              <span style={{ width: '40px', height: '40px', borderRadius: '12px', background: isHighRisk ? `linear-gradient(135deg, ${COLORS.danger}, #F97316)` : `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})`, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="white">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </span>
              Review–Endorsement–Approval Chain
            </h3>

            {filteredResult ? (
              <div className="animate-fadeIn">
                <div style={{ padding: '16px', borderRadius: '12px', marginBottom: '16px', backgroundColor: isHighRisk ? theme.dangerBg : `${COLORS.primary}10`, border: `1px solid ${isHighRisk ? 'rgba(239,68,68,0.2)' : COLORS.primary + '20'}` }}>
                  <p data-testid="result-rule-code" style={{ fontSize: '12px', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '4px', color: isHighRisk ? theme.dangerText : COLORS.primary }}>
                    {filteredResult.code && `${filteredResult.code} • `}Applicable Rule
                  </p>
                  <p style={{ fontSize: '20px', fontWeight: 'bold', color: theme.text }}>{filteredResult.name}</p>
                  {selectedCountry && <p style={{ color: theme.textMuted, fontSize: '14px', marginTop: '4px' }}>Market: {selectedCountry}</p>}
                </div>

                {/* Grouped R → E → X Approval Chain */}
                {(() => {
                  const PHASE_CONFIG = {
                    'R': { label: 'Review / Recommend', color: '#0EA5E9', bgColor: 'rgba(14,165,233,0.08)', borderColor: 'rgba(14,165,233,0.25)', gradient: 'linear-gradient(135deg, #0EA5E9, #38BDF8)' },
                    'E': { label: 'Endorse', color: '#F59E0B', bgColor: 'rgba(245,158,11,0.08)', borderColor: 'rgba(245,158,11,0.25)', gradient: 'linear-gradient(135deg, #F59E0B, #FBBF24)' },
                    'X': { label: 'Approve', color: isHighRisk ? COLORS.danger : '#10B981', bgColor: isHighRisk ? 'rgba(239,68,68,0.08)' : 'rgba(16,185,129,0.08)', borderColor: isHighRisk ? 'rgba(239,68,68,0.25)' : 'rgba(16,185,129,0.25)', gradient: isHighRisk ? `linear-gradient(135deg, ${COLORS.danger}, #F97316)` : 'linear-gradient(135deg, #10B981, #34D399)' },
                    'N': { label: 'Notify', color: '#6B7280', bgColor: 'rgba(107,114,128,0.08)', borderColor: 'rgba(107,114,128,0.25)', gradient: 'linear-gradient(135deg, #6B7280, #9CA3AF)' },
                    'I': { label: 'Initiate', color: '#8B5CF6', bgColor: 'rgba(139,92,246,0.08)', borderColor: 'rgba(139,92,246,0.25)', gradient: 'linear-gradient(135deg, #8B5CF6, #A78BFA)' }
                  };

                  // Group approvers by phase in display order: R → E → X → N → I
                  const phaseOrder = ['R', 'E', 'X', 'N', 'I'];
                  const allApprovers = filteredResult.approvers || [];
                  const phases = phaseOrder.map(phaseLetter => ({
                    key: phaseLetter,
                    config: PHASE_CONFIG[phaseLetter],
                    approvers: allApprovers.filter(a => (a.action || '')[0] === phaseLetter)
                  })).filter(p => p.approvers.length > 0);

                  // Count total phases with content for arrow display
                  const totalPhases = phases.length;

                  return (
                    <div data-testid="approval-chain-container" style={{ display: 'flex', position: 'relative' }}>
                      {/* Vertical Arrow with START/END labels */}
                      <div data-testid="approval-flow-arrow" style={{
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        marginRight: '16px',
                        paddingTop: '8px',
                        paddingBottom: '8px',
                        minWidth: '50px',
                        flexShrink: 0
                      }}>
                        <span data-testid="approval-flow-end" style={{
                          fontSize: '11px',
                          fontWeight: '700',
                          color: COLORS.danger,
                          letterSpacing: '0.05em'
                        }}>END</span>
                        <div style={{
                          flex: 1,
                          display: 'flex',
                          flexDirection: 'column',
                          alignItems: 'center',
                          justifyContent: 'center',
                          margin: '8px 0'
                        }}>
                          <svg width="20" height="20" viewBox="0 0 24 24" fill={COLORS.danger} style={{ marginBottom: '-4px' }}>
                            <path d="M12 4l-8 8h5v8h6v-8h5z"/>
                          </svg>
                          <div style={{
                            width: '3px',
                            flex: 1,
                            minHeight: '60px',
                            backgroundColor: COLORS.danger,
                            borderRadius: '2px'
                          }}></div>
                        </div>
                        <span data-testid="approval-flow-start" style={{
                          fontSize: '11px',
                          fontWeight: '700',
                          color: COLORS.danger,
                          letterSpacing: '0.05em'
                        }}>START</span>
                      </div>

                      {/* Phase-grouped Approver Cards: reversed so X at top, R at bottom (START→R→E→X→END) */}
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', flex: 1 }}>
                        {[...phases].reverse().map((phase, phaseIdx) => {
                          const reversedApprovers = [...phase.approvers].reverse();
                          return (
                            <div key={phase.key} data-testid={`phase-group-${phase.key}`}>
                              {/* Phase Section Header */}
                              <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '8px',
                                marginTop: phaseIdx > 0 ? '8px' : '0'
                              }}>
                                <div style={{
                                  height: '2px',
                                  flex: 1,
                                  background: `linear-gradient(90deg, ${phase.config.color}50, transparent)`
                                }}></div>
                                <span style={{
                                  fontSize: '11px',
                                  fontWeight: '700',
                                  letterSpacing: '0.08em',
                                  textTransform: 'uppercase',
                                  color: phase.config.color,
                                  padding: '3px 10px',
                                  borderRadius: '6px',
                                  backgroundColor: phase.config.bgColor,
                                  border: `1px solid ${phase.config.borderColor}`,
                                  whiteSpace: 'nowrap'
                                }}>{phase.config.label}</span>
                                <div style={{
                                  height: '2px',
                                  flex: 1,
                                  background: `linear-gradient(90deg, transparent, ${phase.config.color}50)`
                                }}></div>
                              </div>

                              {/* Approver cards within this phase */}
                              <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                                {reversedApprovers.map((approver, idx) => {
                                  const withinPhaseNumber = phase.approvers.length - idx;
                                  return (
                                    <div key={idx} data-testid="approver-card" data-role={approver.role} data-action={approver.action} style={{
                                      display: 'flex',
                                      alignItems: 'center',
                                      justifyContent: 'space-between',
                                      backgroundColor: theme.inputBg,
                                      borderRadius: '12px',
                                      padding: '14px 16px',
                                      border: `1px solid ${phase.config.borderColor}`
                                    }}>
                                      <div style={{ display: 'flex', alignItems: 'center', gap: '14px' }}>
                                        <div data-testid="approver-number" style={{
                                          width: '36px',
                                          height: '36px',
                                          borderRadius: '50%',
                                          background: phase.config.gradient,
                                          display: 'flex',
                                          alignItems: 'center',
                                          justifyContent: 'center',
                                          fontSize: '13px',
                                          fontWeight: 'bold',
                                          color: 'white',
                                          flexShrink: 0
                                        }}>
                                          {phase.key}{withinPhaseNumber}
                                        </div>
                                        <div>
                                          <p data-testid="approver-role" style={{ color: theme.text, fontWeight: '600', fontSize: '14px' }}>{approver.role}</p>
                                          <p style={{ color: theme.textMuted, fontSize: '13px' }}>{DOA_DATA.glossary[approver.action[0]]}</p>
                                        </div>
                                      </div>
                                      <ActionBadge action={approver.action} label={approver.label} settings={settings} theme={theme} />
                                    </div>
                                  );
                                })}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  );
                })()}

                {/* Excluded approvers */}
                {filteredResult.excludedApprovers && filteredResult.excludedApprovers.length > 0 && (
                  <div style={{ marginTop: '16px', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px', border: `1px solid ${theme.cardBorder}` }}>
                    <p style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', marginBottom: '8px' }}>Excluded (X without number)</p>
                    {filteredResult.excludedApprovers.map((approver, idx) => (
                      <div key={idx} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', color: theme.textSubtle }}>
                        <span style={{ textDecoration: 'line-through' }}>{approver.role}</span>
                        <span style={{ textDecoration: 'line-through', fontSize: '14px' }}>{approver.action}</span>
                      </div>
                    ))}
                  </div>
                )}

                {filteredResult.notes && (
                  <div style={{ marginTop: '24px', padding: '16px', backgroundColor: theme.warningBg, border: `1px solid ${COLORS.warning}30`, borderRadius: '12px' }}>
                    <p style={{ fontSize: '12px', color: theme.warningText, textTransform: 'uppercase', marginBottom: '4px' }}>Important Notes</p>
                    <p style={{ color: theme.warningText, fontSize: '14px', opacity: 0.9 }}>{filteredResult.notes}</p>
                  </div>
                )}
              </div>
            ) : (
              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '256px', textAlign: 'center' }}>
                <div style={{ width: '64px', height: '64px', borderRadius: '50%', backgroundColor: theme.tagBg, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '16px' }}>
                  <svg width="32" height="32" fill="none" viewBox="0 0 24 24" stroke={theme.textSubtle}>
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <p style={{ color: theme.textMuted }}>Enter opportunity details to see the approval chain</p>
              </div>
            )}
          </div>
        </div>
      );
    };

    // DOA Browser Component with Collapsible Hierarchy
    // Load Browse DOA data from embedded JSON (Excel-derived)
    const BROWSE_DOA_DATA = (() => {
      const el = document.getElementById('browse-doa-data');
      if (el) {
        try { return JSON.parse(el.textContent); } catch (e) { console.error('Failed to parse browse-doa-data:', e); }
      }
      return [];
    })();

    // Run data quality diagnostics once on load
    validateDOAData(BROWSE_DOA_DATA);

    const DOABrowser = ({ settings, theme }) => {
      const [searchTerm, setSearchTerm] = useState('');
      const [expandedSections, setExpandedSections] = useState(new Set());
      const [filterFunction, setFilterFunction] = useState('');
      const [selectedDetails, setSelectedDetails] = useState(null);

      // Normalize function names to handle typos and inconsistencies in source data
      const normalizeFunction = (func) => {
        if (!func) return '';
        let normalized = func.trim(); // Remove leading/trailing spaces
        // Fix common typos and variations
        const corrections = {
          'Human Recourses': 'Human Resources',
          'Corporate  Finance': 'Corporate Finance', // double space
          'Corproate Finance': 'Corporate Finance', // typo
          'End user all functions': 'End User',
          'End user of all functions': 'End User',
          'End user all functions ': 'End User',
          'End user of all functions ': 'End User',
          'End user': 'End User',
          'Commercial and Marketing': 'Commercial & Marketing',
          'Corporate Treasury ': 'Corporate Treasury',
          'TAQA General Assebmbly': 'TAQA General Assembly', // typo
        };
        return corrections[normalized] || normalized;
      };

      // Get all unique functions from the data (normalized)
      const allFunctions = useMemo(() => {
        const funcs = new Set();
        BROWSE_DOA_DATA.forEach(item => {
          if (item.function) funcs.add(normalizeFunction(item.function));
        });
        return Array.from(funcs).sort();
      }, []);

      // Numeric code comparison function
      const compareCodeNumerically = (a, b) => {
        const partsA = a.split('.').map(Number);
        const partsB = b.split('.').map(Number);
        for (let i = 0; i < Math.max(partsA.length, partsB.length); i++) {
          const valA = partsA[i] || 0;
          const valB = partsB[i] || 0;
          if (valA !== valB) return valA - valB;
        }
        return 0;
      };

      // Get parent code (e.g., '4.2.3.2' -> '4.2.3', '4' -> null)
      const getParentCode = (code) => {
        const parts = code.split('.');
        if (parts.length <= 1) return null;
        return parts.slice(0, -1).join('.');
      };

      // Build hierarchical tree structure from Excel-derived data
      const { hierarchy, allNodeCodes, matchingCodes } = useMemo(() => {
        // Start with all items
        let items = BROWSE_DOA_DATA;

        // Track which codes match the filters (for function filtering)
        const matchedCodes = new Set();

        // Apply search filter
        if (searchTerm) {
          const term = searchTerm.toLowerCase();
          items = items.filter(item =>
            item.code.toLowerCase().includes(term) ||
            item.title.toLowerCase().includes(term) ||
            (item.description && item.description.toLowerCase().includes(term)) ||
            (item.comments && item.comments.toLowerCase().includes(term))
          );
        }

        // Apply function filter (using normalized names)
        if (filterFunction) {
          items = items.filter(item => normalizeFunction(item.function) === filterFunction);
        }

        // Track matched codes
        items.forEach(item => matchedCodes.add(item.code));

        // Create a map of all nodes
        const nodeMap = new Map();
        const allCodes = new Set();

        // Process each Excel row - use first occurrence for each code
        items.forEach(item => {
          const code = item.code;
          allCodes.add(code);

          // If this code already exists, skip (keep first occurrence)
          if (nodeMap.has(code)) return;

          const parts = code.split('.');
          const isRoot = parts.length === 1;

          nodeMap.set(code, {
            code: code,
            title: item.title,
            description: item.description || '',
            comments: item.comments || '',
            function: normalizeFunction(item.function) || '',
            approvalChain: item.approvalChain || [],
            isRoot: isRoot,
            children: [],
            fromExcel: true
          });
        });

        // Ensure all ancestor nodes exist (create synthetic if missing)
        const ensureAncestors = (code) => {
          const parts = code.split('.');
          let currentPath = '';
          for (let i = 0; i < parts.length - 1; i++) {
            currentPath = i === 0 ? parts[0] : currentPath + '.' + parts[i];
            allCodes.add(currentPath);
            if (!nodeMap.has(currentPath)) {
              // Try to find title from any item with this exact code
              const existingItem = BROWSE_DOA_DATA.find(it => it.code === currentPath);
              const title = existingItem ? existingItem.title : `Section ${currentPath}`;
              nodeMap.set(currentPath, {
                code: currentPath,
                title: title,
                description: existingItem?.description || '',
                comments: existingItem?.comments || '',
                function: existingItem?.function || '',
                approvalChain: existingItem?.approvalChain || [],
                isRoot: i === 0,
                children: [],
                fromExcel: !!existingItem
              });
            }
          }
        };

        // Ensure ancestors for all items
        items.forEach(item => ensureAncestors(item.code));

        // Build parent-child relationships
        nodeMap.forEach((node, code) => {
          const parentCode = getParentCode(code);
          if (parentCode && nodeMap.has(parentCode)) {
            const parentNode = nodeMap.get(parentCode);
            if (!parentNode.children.find(c => c.code === code)) {
              parentNode.children.push(node);
            }
          }
        });

        // Sort children at each level numerically
        const sortChildren = (node) => {
          node.children.sort((a, b) => compareCodeNumerically(a.code, b.code));
          node.children.forEach(sortChildren);
        };

        // Get root nodes (integer codes like 1, 2, 3...)
        const roots = [];
        nodeMap.forEach((node, code) => {
          if (node.isRoot) {
            sortChildren(node);
            roots.push(node);
          }
        });

        roots.sort((a, b) => compareCodeNumerically(a.code, b.code));

        return { hierarchy: roots, allNodeCodes: Array.from(allCodes), matchingCodes: matchedCodes };
      }, [searchTerm, filterFunction]);

      // Auto-expand sections when searching or filtering
      useEffect(() => {
        if (searchTerm || filterFunction) {
          setExpandedSections(new Set(allNodeCodes));
        }
      }, [searchTerm, filterFunction, allNodeCodes]);

      // Get all section codes for expand/collapse all
      const getAllSectionCodes = () => allNodeCodes;

      const toggleSection = (code) => {
        setExpandedSections(prev => {
          const newSet = new Set(prev);
          if (newSet.has(code)) {
            newSet.delete(code);
          } else {
            newSet.add(code);
          }
          return newSet;
        });
      };

      const expandAll = () => {
        setExpandedSections(new Set(getAllSectionCodes()));
      };

      const collapseAll = () => {
        setExpandedSections(new Set());
      };

      // Count all nodes in hierarchy
      const countAllNodes = (nodes) => {
        return nodes.reduce((sum, node) => {
          return sum + 1 + (node.children ? countAllNodes(node.children) : 0);
        }, 0);
      };

      const inputStyle = { width: '100%', padding: '12px 16px', borderRadius: '12px', border: `1px solid ${theme.cardBorder}`, backgroundColor: theme.inputBg, color: theme.text, fontSize: '14px' };

      return (
        <div data-testid="browse-doa-root">
          <div style={{ display: 'flex', gap: '16px', marginBottom: '24px', flexWrap: 'wrap' }}>
            <div style={{ flex: '1', minWidth: '200px', maxWidth: '400px' }}>
              <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: theme.textMuted, marginBottom: '8px' }}>Search</label>
              <input type="text" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} placeholder="Search by code, title, or description..." style={inputStyle} />
            </div>
            <div style={{ minWidth: '200px' }}>
              <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: theme.textMuted, marginBottom: '8px' }}>Filter by Function</label>
              <div style={{ display: 'flex', gap: '8px' }}>
                <select
                  data-testid="browse-filter-function"
                  value={filterFunction}
                  onChange={(e) => setFilterFunction(e.target.value)}
                  style={{ ...inputStyle, cursor: 'pointer' }}
                >
                  <option value="" data-testid="browse-filter-function-option-">All functions</option>
                  {allFunctions.map(func => (
                    <option key={func} value={func} data-testid={`browse-filter-function-option-${func.replace(/\s+/g, '-')}`}>{func}</option>
                  ))}
                </select>
                {filterFunction && (
                  <button
                    data-testid="browse-filter-clear"
                    onClick={() => { setFilterFunction(''); setExpandedSections(new Set()); }}
                    style={{ padding: '8px 12px', fontSize: '12px', backgroundColor: COLORS.danger + '20', color: COLORS.danger, borderRadius: '8px', whiteSpace: 'nowrap' }}
                  >
                    Clear
                  </button>
                )}
              </div>
            </div>
          </div>

          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px', flexWrap: 'wrap', gap: '8px' }}>
            <p style={{ color: theme.textMuted }}>
              Showing <span style={{ color: COLORS.primary, fontWeight: '600' }}>{countAllNodes(hierarchy)}</span> items in <span style={{ color: COLORS.primary, fontWeight: '600' }}>{hierarchy.length}</span> chapters
            </p>
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                data-testid="browse-expand-all"
                onClick={expandAll}
                style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: theme.tagBg, color: theme.textMuted, borderRadius: '8px' }}
              >
                Expand All
              </button>
              <button
                data-testid="browse-collapse-all"
                onClick={collapseAll}
                style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: theme.tagBg, color: theme.textMuted, borderRadius: '8px' }}
              >
                Collapse All
              </button>
              {searchTerm && (
                <button
                  onClick={() => { setSearchTerm(''); setExpandedSections(new Set()); }}
                  style={{ padding: '6px 12px', fontSize: '12px', backgroundColor: COLORS.danger + '20', color: COLORS.danger, borderRadius: '8px' }}
                >
                  Clear Search
                </button>
              )}
            </div>
          </div>

          {/* Version and reference notes */}
          <div style={{ marginBottom: '16px', padding: '12px 16px', backgroundColor: theme.tagBg, borderRadius: '8px', fontSize: '12px', color: theme.textMuted }}>
            <div style={{ fontWeight: '600', marginBottom: '4px' }}>DOA Reader v4.0 (reference only)</div>
            <div>Do not replace the main DOA file for verification.</div>
            <div style={{ marginTop: '4px' }}>Technical support (bug fixes): atkachyov@tq.com</div>
          </div>

          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
            {hierarchy.map((node) => (
              <BrowseTreeNode
                key={node.code}
                node={node}
                level={0}
                expandedSections={expandedSections}
                toggleSection={toggleSection}
                selectedDetails={selectedDetails}
                setSelectedDetails={setSelectedDetails}
                theme={theme}
              />
            ))}
          </div>
        </div>
      );
    };

    // Render approval chain block for Browse DOA
    const BrowseApprovalChain = ({ node, theme }) => {
      const code = node.code;
      const approvalChain = node.approvalChain || [];

      // Sort approvers using the same normalized order (I → R → E → X)
      const sortedApprovers = normalizeAndSortApprovers(
        approvalChain.map(a => ({ role: a.role, action: a.action }))
      );

      // Hide entirely if no approval chain
      if (sortedApprovers.length === 0) {
        return null;
      }

      return (
        <div data-testid={`browse-approval-chain-${code}`} style={{ marginTop: '12px' }}>
          <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '8px' }}>Approval Chain</h5>
          <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
            {sortedApprovers.map((approver, idx) => (
              <div
                key={`${approver.role}-${idx}`}
                data-testid={`browse-approver-row-${code}-${idx}`}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  padding: '8px 12px',
                  backgroundColor: theme.tagBg,
                  borderRadius: '6px'
                }}
              >
                <span
                  data-testid={`browse-approver-role-${code}-${idx}`}
                  style={{ flex: 1, color: theme.text, fontSize: '14px' }}
                >
                  {approver.role}
                </span>
                <span
                  data-testid={`browse-approver-token-${code}-${idx}`}
                  style={{
                    padding: '2px 8px',
                    borderRadius: '4px',
                    fontSize: '12px',
                    fontFamily: 'monospace',
                    fontWeight: '600',
                    backgroundColor: approver.action.startsWith('X') ? `${COLORS.success}20` :
                                    approver.action.startsWith('E') ? `${COLORS.warning}20` :
                                    approver.action.startsWith('R') ? `${COLORS.info}20` :
                                    approver.action.startsWith('I') ? `${COLORS.primary}20` : theme.tagBg,
                    color: approver.action.startsWith('X') ? COLORS.success :
                           approver.action.startsWith('E') ? COLORS.warning :
                           approver.action.startsWith('R') ? COLORS.info :
                           approver.action.startsWith('I') ? COLORS.primary : theme.text
                  }}
                >
                  {approver.action}
                </span>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Recursive BrowseTreeNode component for Browse DOA hierarchical display (Excel-derived)
    const BrowseTreeNode = ({ node, level, expandedSections, toggleSection, selectedDetails, setSelectedDetails, theme }) => {
      const isExpanded = expandedSections.has(node.code);
      const hasChildren = node.children && node.children.length > 0;
      const indentPx = level * 20;

      // Count all descendant items
      const countDescendants = (n) => {
        if (!n.children || n.children.length === 0) return 1;
        return n.children.reduce((sum, child) => sum + countDescendants(child), 0);
      };
      const descendantCount = countDescendants(node);

      // For root sections (chapters)
      if (node.isRoot) {
        return (
          <div data-testid={`doa-section-node-${node.code}`} style={{ backgroundColor: theme.cardBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '12px', overflow: 'hidden' }}>
            <button
              data-testid={`doa-section-toggle-${node.code}`}
              aria-expanded={isExpanded}
              onClick={() => toggleSection(node.code)}
              style={{
                width: '100%',
                padding: '16px 20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'space-between',
                backgroundColor: 'transparent',
                color: theme.text,
                cursor: 'pointer',
                textAlign: 'left',
                border: 'none'
              }}
            >
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                <span style={{
                  padding: '6px 14px',
                  borderRadius: '8px',
                  fontSize: '16px',
                  fontFamily: 'monospace',
                  fontWeight: '700',
                  backgroundColor: `${COLORS.primary}30`,
                  color: COLORS.primary
                }}>
                  {node.code}
                </span>
                <span data-testid={`doa-title-${node.code}`} style={{ fontSize: '16px', fontWeight: '600' }}>{node.title}</span>
                <span style={{ fontSize: '14px', color: theme.textMuted }}>({descendantCount} items)</span>
              </div>
              <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={theme.textMuted} style={{ transform: isExpanded ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.2s', flexShrink: 0 }}>
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
              </svg>
            </button>

            {isExpanded && (
              <div style={{ borderTop: `1px solid ${theme.cardBorder}`, padding: '12px' }}>
                {/* Approval chain for root node */}
                <BrowseApprovalChain node={node} theme={theme} />

                {/* Children */}
                {hasChildren && (
                  <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', marginTop: '12px' }}>
                    {node.children.map((child) => (
                      <BrowseTreeNode
                        key={child.code}
                        node={child}
                        level={1}
                        expandedSections={expandedSections}
                        toggleSection={toggleSection}
                        selectedDetails={selectedDetails}
                        setSelectedDetails={setSelectedDetails}
                        theme={theme}
                      />
                    ))}
                  </div>
                )}
              </div>
            )}
          </div>
        );
      }

      // For non-root nodes (subsections)
      return (
        <div
          data-testid={`doa-section-node-${node.code}`}
          style={{
            backgroundColor: theme.inputBg,
            border: `1px solid ${theme.cardBorder}`,
            borderRadius: '12px',
            overflow: 'hidden',
            marginLeft: `${indentPx}px`
          }}
        >
          <button
            data-testid={`doa-section-toggle-${node.code}`}
            aria-expanded={isExpanded}
            onClick={() => toggleSection(node.code)}
            style={{
              width: '100%',
              padding: '16px',
              display: 'flex',
              alignItems: 'flex-start',
              justifyContent: 'space-between',
              gap: '16px',
              backgroundColor: 'transparent',
              color: theme.text,
              cursor: 'pointer',
              textAlign: 'left',
              border: 'none'
            }}
          >
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px', flexWrap: 'wrap' }}>
                <span style={{
                  padding: '4px 12px',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontFamily: 'monospace',
                  fontWeight: '600',
                  backgroundColor: `${COLORS.primary}20`,
                  color: COLORS.primary
                }}>{node.code}</span>
                {hasChildren && <span style={{ fontSize: '12px', color: theme.textMuted }}>({descendantCount} items)</span>}
                {node.function && <span style={{ fontSize: '12px', padding: '2px 8px', backgroundColor: theme.tagBg, borderRadius: '4px', color: theme.textMuted }}>{node.function}</span>}
              </div>
              <h4 data-testid={`doa-title-${node.code}`} style={{ color: theme.text, fontWeight: '500', margin: 0 }}>{node.title}</h4>
            </div>
            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={theme.textMuted} style={{ transform: isExpanded ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.2s', flexShrink: 0 }}>
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          {/* Expanded content: description, comments, approval chain, children */}
          {isExpanded && (
            <div style={{ borderTop: `1px solid ${theme.cardBorder}`, padding: '16px', backgroundColor: theme.cardBg }}>
              {/* Description */}
              {node.description && (
                <div data-testid={`doa-description-${node.code}`} style={{ marginBottom: '12px' }}>
                  <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '4px' }}>Description</h5>
                  <p style={{ color: theme.text, fontSize: '14px', margin: 0 }}>{node.description}</p>
                </div>
              )}

              {/* Comments */}
              {node.comments && (
                <div data-testid={`doa-comments-${node.code}`} style={{ marginBottom: '12px' }}>
                  <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '4px' }}>Comments</h5>
                  <div style={{ padding: '12px', backgroundColor: theme.warningBg, border: `1px solid ${COLORS.warning}30`, borderRadius: '8px' }}>
                    <p style={{ color: theme.warningText, fontSize: '14px', margin: 0 }}>{node.comments}</p>
                  </div>
                </div>
              )}

              {/* Approval Chain */}
              <BrowseApprovalChain node={node} theme={theme} />

              {/* Children */}
              {hasChildren && (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', marginTop: '12px' }}>
                  {node.children.map((child) => (
                    <BrowseTreeNode
                      key={child.code}
                      node={child}
                      level={level + 1}
                      expandedSections={expandedSections}
                      toggleSection={toggleSection}
                      selectedDetails={selectedDetails}
                      setSelectedDetails={setSelectedDetails}
                      theme={theme}
                    />
                  ))}
                </div>
              )}
            </div>
          )}
        </div>
      );
    };

    // Recursive TreeNode component for hierarchical display (used by estimator)
    const TreeNode = ({ node, level, expandedSections, toggleSection, expandedDetails, setExpandedDetails, selectedRole, settings, theme }) => {
      const isExpanded = expandedSections.has(node.code);
      const hasChildren = node.children && node.children.length > 0;
      const isLeaf = !hasChildren;
      const item = node.item;
      const itemKey = node.code;
      const isDetailExpanded = expandedDetails === itemKey;

      // Count all descendant leaf items
      const countLeafItems = (n) => {
        if (!n.children || n.children.length === 0) return n.item ? 1 : 0;
        return n.children.reduce((sum, child) => sum + countLeafItems(child), 0);
      };
      const leafCount = countLeafItems(node);

      // Determine padding based on level
      const indentPx = level * 20;

      // For root sections (level 0) - main category headers
      if (node.isRoot) {
        return (
          <div data-testid={`doa-section-node-${node.code}`} style={{ backgroundColor: theme.cardBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '12px', overflow: 'hidden' }}>
            <button
              data-testid={`doa-section-toggle-${node.code}`}
              aria-expanded={isExpanded}
              onClick={() => toggleSection(node.code)}
              style={{
                width: '100%',
                padding: '16px 20px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'space-between',
                backgroundColor: 'transparent',
                color: theme.text,
                cursor: 'pointer',
                textAlign: 'left',
                border: 'none'
              }}
            >
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                <span style={{
                  padding: '6px 14px',
                  borderRadius: '8px',
                  fontSize: '16px',
                  fontFamily: 'monospace',
                  fontWeight: '700',
                  backgroundColor: `${COLORS.primary}30`,
                  color: COLORS.primary
                }}>
                  {node.code}
                </span>
                <span style={{ fontSize: '16px', fontWeight: '600' }}>{node.name}</span>
                <span style={{ fontSize: '14px', color: theme.textMuted }}>({leafCount} items)</span>
              </div>
              <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={theme.textMuted} style={{ transform: isExpanded ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.2s', flexShrink: 0 }}>
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
              </svg>
            </button>

            {isExpanded && hasChildren && (
              <div style={{ borderTop: `1px solid ${theme.cardBorder}`, padding: '12px' }}>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                  {node.children.map((child) => (
                    <TreeNode
                      key={child.code}
                      node={child}
                      level={1}
                      expandedSections={expandedSections}
                      toggleSection={toggleSection}
                      expandedDetails={expandedDetails}
                      setExpandedDetails={setExpandedDetails}
                      selectedRole={selectedRole}
                      settings={settings}
                      theme={theme}
                    />
                  ))}
                </div>
              </div>
            )}
          </div>
        );
      }

      // For non-root nodes (subsections and leaf items)
      return (
        <div
          data-testid={`doa-section-node-${node.code}`}
          style={{
            backgroundColor: theme.inputBg,
            border: `1px solid ${theme.cardBorder}`,
            borderRadius: '12px',
            overflow: 'hidden',
            marginLeft: `${indentPx}px`
          }}
        >
          <button
            data-testid={`doa-section-toggle-${node.code}`}
            aria-expanded={hasChildren ? isExpanded : isDetailExpanded}
            onClick={() => hasChildren ? toggleSection(node.code) : setExpandedDetails(isDetailExpanded ? null : itemKey)}
            style={{
              width: '100%',
              padding: '16px',
              display: 'flex',
              alignItems: 'flex-start',
              justifyContent: 'space-between',
              gap: '16px',
              backgroundColor: 'transparent',
              color: theme.text,
              cursor: 'pointer',
              textAlign: 'left',
              border: 'none'
            }}
          >
            <div style={{ flex: 1 }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px', flexWrap: 'wrap' }}>
                <span style={{
                  padding: '4px 12px',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontFamily: 'monospace',
                  fontWeight: '600',
                  backgroundColor: node.isSynthetic ? `${COLORS.warning}20` : `${COLORS.primary}20`,
                  color: node.isSynthetic ? COLORS.warning : COLORS.primary
                }}>{node.code}</span>
                {item && item.applies_to && <span style={{ padding: '4px 8px', backgroundColor: theme.tagBg, color: theme.textMuted, borderRadius: '4px', fontSize: '12px' }}>{item.applies_to}</span>}
                {hasChildren && <span style={{ fontSize: '12px', color: theme.textMuted }}>({leafCount} items)</span>}
                {node.isSynthetic && <span style={{ fontSize: '11px', color: theme.textMuted, fontStyle: 'italic' }}>synthetic</span>}
              </div>
              <h4 style={{ color: theme.text, fontWeight: '500', margin: 0 }}>{node.name}</h4>
              {item && item.business_owner && <p style={{ color: theme.textSubtle, fontSize: '14px', marginTop: '4px', marginBottom: 0 }}>Owner: {item.business_owner}</p>}
            </div>
            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke={theme.textMuted} style={{ transform: (hasChildren ? isExpanded : isDetailExpanded) ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.2s', flexShrink: 0 }}>
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          {/* Children (for non-leaf nodes) */}
          {hasChildren && isExpanded && (
            <div style={{ borderTop: `1px solid ${theme.cardBorder}`, padding: '12px' }}>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                {node.children.map((child) => (
                  <TreeNode
                    key={child.code}
                    node={child}
                    level={level + 1}
                    expandedSections={expandedSections}
                    toggleSection={toggleSection}
                    expandedDetails={expandedDetails}
                    setExpandedDetails={setExpandedDetails}
                    selectedRole={selectedRole}
                    settings={settings}
                    theme={theme}
                  />
                ))}
              </div>
            </div>
          )}

          {/* Details (for leaf nodes with real items) */}
          {isLeaf && item && isDetailExpanded && (
            <div style={{ borderTop: `1px solid ${theme.cardBorder}`, padding: '16px', backgroundColor: theme.cardBg }}>
              {/* Description */}
              <div data-testid={`doa-description-${item.code}`} style={{ marginBottom: '12px' }}>
                <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '4px' }}>Description</h5>
                <p style={{ color: theme.text, fontSize: '14px', margin: 0 }}>{item.description || 'No description provided'}</p>
              </div>

              {/* Comments / Interpretation */}
              <div data-testid={`doa-comments-${item.code}`} style={{ marginBottom: '16px' }}>
                <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '4px' }}>Comments</h5>
                {item.interpretation ? (
                  <div style={{ padding: '12px', backgroundColor: theme.warningBg, border: `1px solid ${COLORS.warning}30`, borderRadius: '8px' }}>
                    <p style={{ color: theme.warningText, fontSize: '14px', margin: 0 }}>{item.interpretation}</p>
                  </div>
                ) : (
                  <p style={{ color: theme.textMuted, fontSize: '14px', margin: 0, fontStyle: 'italic' }}>No comments</p>
                )}
              </div>

              {/* Approval Chain */}
              {item.approvers && (
                <div>
                  <h5 style={{ fontSize: '12px', color: theme.textSubtle, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '12px' }}>Approval Chain</h5>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '12px' }}>
                    {normalizeAndSortApprovers(Object.entries(item.approvers).map(([role, action]) => ({ role, action }))).map(({ role, action }) => {
                      const isHighlighted = selectedRole && role === selectedRole;
                      return (
                        <div key={role} style={{
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'space-between',
                          backgroundColor: isHighlighted ? `${COLORS.primary}20` : theme.inputBg,
                          borderRadius: '12px',
                          padding: '12px 16px',
                          border: isHighlighted ? `2px solid ${COLORS.primary}` : '1px solid transparent'
                        }}>
                          <span style={{ color: isHighlighted ? COLORS.primary : theme.textMuted, fontSize: '14px', fontWeight: isHighlighted ? '600' : '400' }}>{role}</span>
                          <ActionBadge action={action} settings={settings} theme={theme} />
                        </div>
                      );
                    })}
                  </div>
                </div>
              )}
            </div>
          )}
        </div>
      );
    };

    // Main App
    function App() {
      const [activeTab, setActiveTab] = useState('calculator');
      const [showSettings, setShowSettings] = useState(false);
      
      // Load theme from localStorage, default to light
      const [isDark, setIsDark] = useState(() => 
        loadFromStorage(STORAGE_KEYS.theme, false)
      );
      
      // Load settings from localStorage
      const [settings, setSettings] = useState(() => 
        loadFromStorage(STORAGE_KEYS.settings, {
          countXWithoutNumber: false,
          safeCountries: DEFAULT_SAFE_COUNTRIES.sort(),
          specialCountries: DEFAULT_SPECIAL_COUNTRIES.sort()
        })
      );

      // Load form state from localStorage (persists across tab switches)
      const [formState, setFormState] = useState(() =>
        loadFromStorage(STORAGE_KEYS.formState, DEFAULT_FORM_STATE)
      );

      // Persist theme changes
      useEffect(() => {
        saveToStorage(STORAGE_KEYS.theme, isDark);
      }, [isDark]);

      // Persist settings changes
      useEffect(() => {
        saveToStorage(STORAGE_KEYS.settings, settings);
      }, [settings]);

      // Persist form state changes
      useEffect(() => {
        saveToStorage(STORAGE_KEYS.formState, formState);
      }, [formState]);

      const theme = isDark ? themes.dark : themes.light;

      return (
        <div style={{ minHeight: '100vh', backgroundColor: theme.pageBg }}>
          {/* Header */}
          <header style={{ borderBottom: `1px solid ${theme.cardBorder}`, backdropFilter: 'blur(12px)', backgroundColor: theme.headerBg, position: 'sticky', top: 0, zIndex: 40 }}>
            <div style={{ maxWidth: '1280px', margin: '0 auto', padding: '16px 24px' }}>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '16px' }}>
                <div>
                  <h1 style={{ fontSize: '24px', fontWeight: 'bold', color: theme.text }}>DOA Reader</h1>
                  <p style={{ color: theme.textMuted, fontSize: '14px' }}>Delegation of Authority • Feb 2026 • v4.0</p>
                </div>

                <div style={{ display: 'flex', alignItems: 'center', gap: '12px', flexWrap: 'wrap' }}>
                  <nav style={{ display: 'flex', gap: '8px', backgroundColor: theme.tagBg, borderRadius: '16px', padding: '6px' }}>
                    <button
                      onClick={() => setActiveTab('calculator')}
                      style={{
                        padding: '10px 16px', borderRadius: '12px', fontSize: '14px', fontWeight: '600',
                        background: activeTab === 'calculator' ? `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})` : 'transparent',
                        color: activeTab === 'calculator' ? 'white' : theme.textMuted, transition: 'all 0.2s'
                      }}
                    >
                      4. Tenders & Contracts (Approvals)
                    </button>
                    <button
                      onClick={() => setActiveTab('browse')}
                      style={{
                        padding: '10px 16px', borderRadius: '12px', fontSize: '14px', fontWeight: '600',
                        background: activeTab === 'browse' ? `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})` : 'transparent',
                        color: activeTab === 'browse' ? 'white' : theme.textMuted, transition: 'all 0.2s'
                      }}
                    >
                      Browse DOA
                    </button>
                    <button
                      onClick={() => setActiveTab('help')}
                      style={{
                        padding: '10px 16px', borderRadius: '12px', fontSize: '14px', fontWeight: '600',
                        background: activeTab === 'help' ? `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})` : 'transparent',
                        color: activeTab === 'help' ? 'white' : theme.textMuted, transition: 'all 0.2s'
                      }}
                    >
                      Help
                    </button>
                  </nav>

                  <ThemeToggle isDark={isDark} onToggle={() => setIsDark(!isDark)} theme={theme} />

                  <button
                    onClick={() => setShowSettings(true)}
                    style={{ padding: '12px', borderRadius: '12px', backgroundColor: theme.tagBg, color: theme.textMuted, position: 'relative', transition: 'all 0.2s' }}
                  >
                    <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span style={{ position: 'absolute', top: '-4px', right: '-4px', width: '18px', height: '18px', borderRadius: '50%', backgroundColor: COLORS.primary, color: 'white', fontSize: '10px', fontWeight: 'bold', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                      {settings.safeCountries.length}
                    </span>
                  </button>
                </div>
              </div>
            </div>
          </header>

          {/* Main */}
          <main style={{ maxWidth: '1280px', margin: '0 auto', padding: '40px 24px' }}>
            {activeTab === 'calculator' && <OpportunityCalculator settings={settings} theme={theme} formState={formState} setFormState={setFormState} />}
            {activeTab === 'browse' && <DOABrowser settings={settings} theme={theme} />}
            {activeTab === 'help' && (
              <div style={{ maxWidth: '800px', margin: '0 auto' }}>
                <div style={{ backgroundColor: theme.card, borderRadius: '24px', border: `1px solid ${theme.cardBorder}`, padding: '32px', boxShadow: theme.cardShadow }}>
                  <h2 style={{ fontSize: '22px', fontWeight: 'bold', color: theme.text, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                    <span style={{ width: '40px', height: '40px', borderRadius: '12px', background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryLight})`, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                      <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="white">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                    </span>
                    Activity Glossary
                  </h2>
                  <p style={{ color: theme.textMuted, marginBottom: '24px', fontSize: '14px' }}>
                    The following codes indicate the type of action/authority assigned to each role in the approval workflow:
                  </p>
                  <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                    <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px' }}>
                      <span style={{ width: '36px', height: '36px', borderRadius: '10px', backgroundColor: COLORS.info, color: 'white', fontWeight: 'bold', fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>I</span>
                      <div>
                        <div style={{ fontWeight: '600', color: theme.text, marginBottom: '4px' }}>Initiate</div>
                        <div style={{ color: theme.textMuted, fontSize: '14px' }}>Start or begin the transaction/process</div>
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px' }}>
                      <span style={{ width: '36px', height: '36px', borderRadius: '10px', backgroundColor: COLORS.warning, color: 'white', fontWeight: 'bold', fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>R</span>
                      <div>
                        <div style={{ fontWeight: '600', color: theme.text, marginBottom: '4px' }}>Review / Recommend</div>
                        <div style={{ color: theme.textMuted, fontSize: '14px' }}>Review/Recommend the transaction; the role to conduct in-depth review of content developed and recommended, challenge output and rationale, investigate alternative ideas, and contribute to the crafting of the final recommendation</div>
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px' }}>
                      <span style={{ width: '36px', height: '36px', borderRadius: '10px', backgroundColor: COLORS.purple, color: 'white', fontWeight: 'bold', fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>E</span>
                      <div>
                        <div style={{ fontWeight: '600', color: theme.text, marginBottom: '4px' }}>Endorse</div>
                        <div style={{ color: theme.textMuted, fontSize: '14px' }}>Endorse and provide formal support to the presented recommendation</div>
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px' }}>
                      <span style={{ width: '36px', height: '36px', borderRadius: '10px', backgroundColor: COLORS.success, color: 'white', fontWeight: 'bold', fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>X</span>
                      <div>
                        <div style={{ fontWeight: '600', color: theme.text, marginBottom: '4px' }}>Approve (Authority)</div>
                        <div style={{ color: theme.textMuted, fontSize: '14px' }}>Authority to approve the transaction as specified in the item column</div>
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', padding: '16px', backgroundColor: theme.tagBg, borderRadius: '12px' }}>
                      <span style={{ width: '36px', height: '36px', borderRadius: '10px', backgroundColor: theme.textSubtle, color: 'white', fontWeight: 'bold', fontSize: '16px', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>N</span>
                      <div>
                        <div style={{ fontWeight: '600', color: theme.text, marginBottom: '4px' }}>Notification</div>
                        <div style={{ color: theme.textMuted, fontSize: '14px' }}>Receive notification about the transaction (no action required)</div>
                      </div>
                    </div>
                  </div>
                  <div style={{ marginTop: '24px', padding: '16px', backgroundColor: `${COLORS.info}15`, borderRadius: '12px', border: `1px solid ${COLORS.info}30` }}>
                    <p style={{ color: theme.text, fontSize: '13px', margin: 0 }}>
                      <strong>Note:</strong> Numbers following the letters (e.g., X1, X2, R1, E2) indicate the sequence or priority of approvals within that action type.
                    </p>
                  </div>
                </div>
              </div>
            )}
          </main>

          {/* Footer */}
          <footer style={{ borderTop: `1px solid ${theme.cardBorder}`, marginTop: '80px' }}>
            <div style={{ maxWidth: '1280px', margin: '0 auto', padding: '24px' }}>
              <p style={{ textAlign: 'center', color: theme.textSubtle, fontSize: '14px' }}>DOA Reader • For Internal Use Only</p>
            </div>
          </footer>

          <SettingsPanel settings={settings} setSettings={setSettings} isOpen={showSettings} onClose={() => setShowSettings(false)} theme={theme} formState={formState} />
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
