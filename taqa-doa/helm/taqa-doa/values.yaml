# Default values for taqa-doa Helm chart
global:
  environment: staging
  registry: acrdoaprod.azurecr.io

server:
  name: doa-server
  replicaCount: 1
  image:
    repository: doa-server
    tag: latest
    pullPolicy: Always
  port: 3000
  env:
    NODE_ENV: production
    LOG_LEVEL: debug
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80

client:
  name: doa-client
  replicaCount: 1
  image:
    repository: doa-client
    tag: latest
    pullPolicy: Always
  port: 80
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"

editor:
  name: doa-editor
  replicaCount: 1
  image:
    repository: doa-editor
    tag: latest
    pullPolicy: Always
  port: 80
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"

postgres:
  enabled: true
  host: postgres
  port: 5432
  database: taqa_doa
  user: doa_user
  # Password must be set via --set postgres.password=<value> or secrets
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  persistence:
    enabled: true
    size: 10Gi
    storageClass: default

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: doa.example.com
      paths:
        - path: /
          pathType: Prefix
          service: doa-client
    - host: doa-editor.example.com
      paths:
        - path: /
          pathType: Prefix
          service: doa-editor
  tls:
    - secretName: doa-tls
      hosts:
        - doa.example.com
        - doa-editor.example.com

serviceAccount:
  create: true
  name: taqa-doa

rbac:
  create: true

securityContext:
  runAsNonRoot: true
  runAsUser: 1001
  fsGroup: 1001
